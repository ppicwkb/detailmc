<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Stok CS</title>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #60a5fa 100%);
            min-height: 100vh;
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.4) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(245, 158, 11, 0.2) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 0;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            min-height: 100vh;
            position: relative;
        }

        .header {
            background: linear-gradient(135deg, #1e40af 0%, #2563eb 100%);
            color: white;
            padding: 32px 24px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 8px 32px rgba(30, 64, 175, 0.4);
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(59, 130, 246, 0.2) 25%, 
                rgba(16, 185, 129, 0.15) 50%, 
                rgba(245, 158, 11, 0.1) 75%, 
                transparent 100%);
            pointer-events: none;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header h1 {
            margin: 0;
            font-size: 2.25rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ffffff 0%, #e2e8f0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: -0.025em;
            text-shadow: none;
        }

        .header p {
            margin: 12px 0 0 0;
            opacity: 0.8;
            font-size: 1rem;
            font-weight: 500;
            color: #cbd5e1;
        }

        .controls {
            padding: 24px 32px;
            background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(248,250,252,0.95) 100%);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.5);
            display: flex;
            gap: 16px;
            align-items: center;
            flex-wrap: wrap;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            position: relative;
        }

        .controls::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent 0%, rgba(102, 126, 234, 0.2) 50%, transparent 100%);
        }

        .search-box {
            flex: 1;
            min-width: 320px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 16px 20px 16px 56px;
            border: 2px solid rgba(226, 232, 240, 0.6);
            border-radius: 16px;
            font-size: 16px;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(248, 250, 252, 0.8);
            backdrop-filter: blur(10px);
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }

        .search-box input:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.2), 0 8px 24px rgba(37, 99, 235, 0.15);
            background: rgba(255, 255, 255, 0.95);
            transform: translateY(-1px);
        }

        .search-box input::placeholder {
            color: #94a3b8;
            font-weight: 400;
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
            font-size: 18px;
        }

        .load-btn {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 16px;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
            position: relative;
            overflow: hidden;
        }

        .load-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s ease;
        }

        .load-btn:hover::before {
            left: 100%;
        }

        .load-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 32px rgba(37, 99, 235, 0.5);
        }

        .load-btn:active {
            transform: translateY(-1px);
        }

        .load-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .control-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .modal-btn {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            padding: 14px 24px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        .modal-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .status {
            padding: 15px 30px;
            text-align: center;
            font-size: 16px;
            font-weight: 500;
        }

        .status.loading {
            color: #2563eb;
            background: #eff6ff;
        }

        .status.error {
            color: #dc2626;
            background: #fef2f2;
        }

        .status.success {
            color: #059669;
            background: #f0fdf4;
        }

        .table-container {
            overflow-x: auto;
            max-height: 70vh;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin: 24px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
        }

        .table-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(102, 126, 234, 0.02) 0%, 
                rgba(118, 75, 162, 0.02) 50%, 
                rgba(16, 185, 129, 0.02) 100%);
            border-radius: 20px;
            pointer-events: none;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            border-radius: 12px;
            overflow: hidden;
        }

        th {
            background: linear-gradient(135deg, #1e40af 0%, #2563eb 100%);
            color: white;
            padding: 20px 16px;
            text-align: left;
            font-weight: 700;
            position: sticky;
            top: 0;
            z-index: 10;
            white-space: nowrap;
            font-size: 14px;
            letter-spacing: 0.025em;
            border-bottom: 2px solid rgba(37, 99, 235, 0.4);
            backdrop-filter: blur(10px);
            position: relative;
        }

        th::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent 0%, rgba(37, 99, 235, 0.6) 50%, transparent 100%);
        }

        td {
            padding: 14px;
            border-bottom: 1px solid #f1f5f9;
            white-space: nowrap;
            font-weight: 500;
        }

        tr:hover {
            background-color: #f8fafc;
            transform: scale(1.001);
            transition: all 0.2s ease;
        }

        tr:nth-child(even) {
            background-color: #fafbfc;
        }

        tr:nth-child(even):hover {
            background-color: #f1f5f9;
        }

        .numeric {
            text-align: right;
            font-family: 'Monaco', 'Menlo', monospace;
            font-weight: 500;
        }

        .brand-cell {
            font-weight: 600;
            color: #374151;
        }

        .date-cell {
            color: #6b7280;
        }

        .code-cell {
            font-family: 'Monaco', 'Menlo', monospace;
            background: #f3f4f6;
            border-radius: 4px;
            padding: 4px 8px;
            font-size: 12px;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .stats {
            padding: 32px 24px;
            background: linear-gradient(135deg, rgba(248,250,252,0.9) 0%, rgba(226,232,240,0.9) 100%);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(226, 232, 240, 0.5);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 24px;
            margin: 0 24px;
            border-radius: 20px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.08);
            position: relative;
        }

        .stats::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(102, 126, 234, 0.05) 0%, 
                rgba(118, 75, 162, 0.05) 50%, 
                rgba(16, 185, 129, 0.05) 100%);
            border-radius: 20px;
            pointer-events: none;
        }

        .stat-item {
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 28px 24px;
            border-radius: 16px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #2563eb 0%, #10b981 50%, #f59e0b 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .stat-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 16px 40px rgba(0,0,0,0.15);
            background: rgba(255, 255, 255, 0.95);
        }

        .stat-item:hover::before {
            opacity: 1;
        }

        .stat-value {
            font-size: 2.25rem;
            font-weight: 800;
            color: #1e293b;
            display: block;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 0.875rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        .filters {
            padding: 15px 30px;
            background: #f1f5f9;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-label {
            font-size: 12px;
            font-weight: 600;
            color: #374151;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-select {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            min-width: 120px;
        }

        .export-btn {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
        }

        .clear-btn {
            background: #6b7280;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .clear-btn:hover {
            background: #4b5563;
        }

        .sort-indicator {
            margin-left: 5px;
            font-size: 12px;
            opacity: 0.7;
        }

        .sort-indicator.active {
            opacity: 1;
            color: #667eea;
        }

        th {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s ease;
        }

        th:hover {
            background: linear-gradient(135deg, #4b5563 0%, #374151 100%);
        }

        .analytics-page {
            display: none;
            padding: 30px;
        }

        .analytics-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .analytics-header h2 {
            font-size: 2.5rem;
            color: #374151;
            margin: 0 0 10px 0;
        }

        .analytics-header p {
            color: #6b7280;
            font-size: 1.1rem;
        }

        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .analytics-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border: 1px solid #e5e7eb;
        }

        .analytics-card h3 {
            margin: 0 0 20px 0;
            color: #374151;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-container {
            height: 250px;
            display: flex;
            align-items: end;
            justify-content: space-around;
            border-bottom: 2px solid #e5e7eb;
            border-left: 2px solid #e5e7eb;
            padding: 20px 10px 10px 10px;
            position: relative;
        }

        .chart-bar {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            border-radius: 4px 4px 0 0;
            min-width: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            transition: all 0.3s ease;
        }

        .chart-bar:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.4);
        }

        .chart-label {
            font-size: 11px;
            color: #6b7280;
            margin-top: 8px;
            text-align: center;
            font-weight: 500;
        }

        .chart-value {
            position: absolute;
            top: -25px;
            font-size: 12px;
            font-weight: 600;
            color: #374151;
            background: white;
            padding: 2px 6px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .metric-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .metric-item:last-child {
            border-bottom: none;
        }

        .metric-label {
            color: #6b7280;
            font-size: 14px;
        }

        .metric-value {
            font-weight: 600;
            color: #374151;
            font-size: 16px;
        }

        .trend-indicator {
            font-size: 12px;
            padding: 2px 6px;
            border-radius: 12px;
            margin-left: 8px;
        }

        .trend-up {
            background: #dcfce7;
            color: #166534;
        }

        .trend-down {
            background: #fef2f2;
            color: #991b1b;
        }

        .pie-chart {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            margin: 0 auto 20px;
            position: relative;
            box-shadow: 0 8px 24px rgba(37, 99, 235, 0.2);
        }

        .pie-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 3px;
        }

        /* KPI Grid Styles */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            padding: 10px 0;
        }

        .kpi-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .kpi-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(37, 99, 235, 0.15);
            border-color: #2563eb;
        }

        .kpi-icon {
            font-size: 2rem;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            border-radius: 50%;
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .kpi-content {
            flex: 1;
        }

        .kpi-value {
            font-size: 1.5rem;
            font-weight: 800;
            color: #1e293b;
            margin-bottom: 4px;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .kpi-label {
            font-size: 0.875rem;
            color: #64748b;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Status Grid Styles */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            padding: 10px 0;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 18px;
            border-radius: 12px;
            border: 2px solid;
            transition: all 0.3s ease;
        }

        .status-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .status-high {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-color: #22c55e;
        }

        .status-medium {
            background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%);
            border-color: #eab308;
        }

        .status-low {
            background: linear-gradient(135deg, #fff7ed 0%, #fed7aa 100%);
            border-color: #f97316;
        }

        .status-empty {
            background: linear-gradient(135deg, #fef2f2 0%, #fecaca 100%);
            border-color: #ef4444;
        }

        .status-icon {
            font-size: 1.5rem;
            width: 45px;
            height: 45px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .status-content {
            flex: 1;
        }

        .status-value {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 2px;
        }

        .status-high .status-value {
            color: #166534;
        }

        .status-medium .status-value {
            color: #a16207;
        }

        .status-low .status-value {
            color: #c2410c;
        }

        .status-empty .status-value {
            color: #dc2626;
        }

        .status-label {
            font-size: 0.8rem;
            font-weight: 600;
            opacity: 0.8;
        }

        /* Distribution Chart Styles */
        .distribution-chart {
            height: 250px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 20px 10px;
        }

        .distribution-bar {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px 0;
        }

        .distribution-label {
            min-width: 80px;
            font-size: 12px;
            font-weight: 600;
            color: #374151;
        }

        .distribution-bar-container {
            flex: 1;
            height: 25px;
            background: #f1f5f9;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
        }

        .distribution-bar-fill {
            height: 100%;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            border-radius: 12px;
            transition: width 0.8s ease;
            position: relative;
        }

        .distribution-value {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 11px;
            font-weight: 600;
            color: #374151;
        }

        /* Mobile Responsive for new components */
        @media (max-width: 768px) {
            .kpi-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .kpi-item {
                padding: 16px;
                gap: 12px;
            }

            .kpi-icon {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }

            .kpi-value {
                font-size: 1.25rem;
            }

            .status-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .status-item {
                padding: 14px;
                gap: 10px;
            }

            .status-icon {
                width: 40px;
                height: 40px;
                font-size: 1.25rem;
            }

            .distribution-chart {
                height: 200px;
                padding: 15px 5px;
            }

            .distribution-bar {
                gap: 10px;
                padding: 8px 0;
            }

            .distribution-label {
                min-width: 60px;
                font-size: 11px;
            }

            .distribution-bar-container {
                height: 20px;
            }
        }

        .top-items {
            max-height: 300px;
            overflow-y: auto;
        }

        .top-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 8px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #2563eb;
        }

        .item-info {
            flex: 1;
        }

        .item-name {
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }

        .item-details {
            font-size: 12px;
            color: #6b7280;
            margin-top: 2px;
        }

        .item-value {
            font-weight: 700;
            color: #2563eb;
            font-size: 16px;
        }

        .nav-tabs {
            display: flex;
            gap: 0;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-bottom: 1px solid rgba(226, 232, 240, 0.5);
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
            position: relative;
        }

        .nav-tabs::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent 0%, #e2e8f0 50%, transparent 100%);
        }

        .nav-tabs::-webkit-scrollbar {
            display: none;
        }

        .nav-tab {
            padding: 20px 32px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 15px;
            font-weight: 700;
            color: #64748b;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
            min-width: 160px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .nav-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(37, 99, 235, 0.15), transparent);
            transition: left 0.6s ease;
        }

        .nav-tab:hover::before {
            left: 100%;
        }

        .nav-tab.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
            background: linear-gradient(135deg, rgba(255,255,255,0.9) 0%, rgba(248,250,252,0.9) 100%);
            box-shadow: 0 -4px 16px rgba(37, 99, 235, 0.2);
            transform: translateY(-2px);
        }

        .nav-tab:hover:not(.active) {
            color: #374151;
            background: rgba(255,255,255,0.8);
            transform: translateY(-1px);
        }

        .alert-badge {
            background: #dc2626;
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 5px;
            font-weight: 600;
        }

        .pagination {
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            background: white;
            margin: 16px 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            border: 1px solid #e2e8f0;
        }

        .pagination button {
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 14px;
        }

        .pagination button:hover:not(:disabled) {
            background: #f8fafc;
            border-color: #2563eb;
            color: #2563eb;
            transform: translateY(-1px);
        }

        .pagination button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .pagination .active {
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            color: white;
            border-color: #2563eb;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
        }

        .page-info {
            margin: 0 16px;
            font-size: 14px;
            color: #64748b;
            font-weight: 500;
        }

        .view-buttons {
            display: flex;
            gap: 4px;
            background: #f1f5f9;
            padding: 4px;
            border-radius: 10px;
            border: 1px solid #e2e8f0;
        }

        .view-btn {
            padding: 10px 16px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #64748b;
        }

        .view-btn.active {
            background: white;
            color: #2563eb;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .view-btn:hover:not(.active) {
            color: #374151;
            background: rgba(255,255,255,0.7);
        }

        /* Mobile-First Responsive Design */
        @media (max-width: 768px) {
            body {
                padding: 0;
                background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
                font-size: 14px;
            }
            
            .container {
                margin: 0;
                border-radius: 0;
                box-shadow: none;
                min-height: 100vh;
                background: rgba(255, 255, 255, 0.98);
            }
            
            .header {
                padding: 16px 12px;
                position: sticky;
                top: 0;
                z-index: 100;
                background: linear-gradient(135deg, #1e40af 0%, #2563eb 100%);
            }
            
            .header h1 {
                font-size: 1.25rem;
                margin-bottom: 4px;
                line-height: 1.3;
            }
            
            .header p {
                font-size: 0.8rem;
                opacity: 0.9;
            }
            
            .header-content > div {
                flex-direction: column;
                gap: 8px;
            }
            
            #recordInfo, #lastModified {
                font-size: 0.75rem !important;
            }
            
            .nav-tabs {
                padding: 0;
                background: rgba(255, 255, 255, 0.95);
                border-bottom: 1px solid #e2e8f0;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                backdrop-filter: blur(10px);
            }
            
            .nav-tab {
                padding: 12px 16px;
                font-size: 13px;
                min-width: 100px;
                font-weight: 600;
                border-radius: 0;
            }
            
            .nav-tab.active {
                background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
                color: white;
                border-bottom: 3px solid #1d4ed8;
            }
            
            .controls {
                padding: 12px;
                flex-direction: column;
                gap: 10px;
                background: rgba(255, 255, 255, 0.95);
                border-bottom: 1px solid #e2e8f0;
                backdrop-filter: blur(10px);
            }
            
            .search-box {
                min-width: auto;
                order: 1;
            }
            
            .search-box input {
                font-size: 16px;
                padding: 14px 14px 14px 44px;
                border-radius: 10px;
                border: 2px solid #e2e8f0;
                background: white;
            }
            
            .search-box input:focus {
                border-color: #2563eb;
                box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
            }
            
            .control-buttons {
                order: 2;
                justify-content: space-between;
                gap: 6px;
                flex-wrap: wrap;
            }
            
            .load-btn {
                padding: 14px 18px;
                font-size: 14px;
                flex: 1;
                min-width: 120px;
                border-radius: 10px;
                font-weight: 600;
            }
            
            .modal-btn {
                padding: 14px 16px;
                font-size: 13px;
                flex: 1;
                min-width: 100px;
                border-radius: 10px;
                font-weight: 600;
            }
            
            .view-buttons {
                flex: 1;
                justify-content: center;
                background: #f1f5f9;
                border-radius: 8px;
                padding: 3px;
            }
            
            .view-btn {
                flex: 1;
                padding: 10px 12px;
                font-size: 12px;
                font-weight: 600;
                border-radius: 6px;
            }
            
            .view-btn.active {
                background: white;
                color: #2563eb;
                box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            }
            
            .filters {
                padding: 16px;
                flex-direction: column;
                gap: 12px;
                background: white;
                margin: 0;
            }
            
            .filter-group {
                width: 100%;
            }
            
            .filter-select {
                width: 100%;
                padding: 14px;
                font-size: 16px;
                border-radius: 10px;
            }
            
            .stats {
                padding: 12px;
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
                margin: 12px;
                border-radius: 10px;
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
            }
            
            .stat-item {
                padding: 16px 12px;
                border-radius: 8px;
                background: white;
                border: 1px solid #e2e8f0;
                text-align: center;
                box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            }
            
            .stat-item:hover {
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(0,0,0,0.12);
            }
            
            .stat-value {
                font-size: 1.5rem;
                margin-bottom: 4px;
                font-weight: 800;
                background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            }
            
            .stat-label {
                font-size: 0.75rem;
                color: #64748b;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                font-weight: 600;
            }
            
            .table-container {
                max-height: 65vh;
                margin: 12px;
                border-radius: 10px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                border: 1px solid #e2e8f0;
            }
            
            table {
                font-size: 12px;
            }
            
            th {
                padding: 10px 6px;
                min-width: 80px;
                font-size: 11px;
                background: linear-gradient(135deg, #1e40af 0%, #2563eb 100%);
                color: white;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }
            
            td {
                padding: 10px 6px;
                min-width: 80px;
                border-bottom: 1px solid #f1f5f9;
            }
            
            tr:hover {
                background-color: #f8fafc;
                transform: none;
            }
            
            .cards-container {
                padding: 12px;
                background: #f8fafc;
            }
            
            .cards-grid {
                grid-template-columns: 1fr;
                gap: 10px;
                max-height: 65vh;
                overflow-y: auto;
                padding: 4px;
            }
            
            .item-card {
                padding: 16px;
                border-radius: 10px;
                background: white;
                border: 1px solid #e2e8f0;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                transition: all 0.2s ease;
            }
            
            .item-card:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 16px rgba(0,0,0,0.15);
            }
            
            .card-header {
                margin-bottom: 12px;
            }
            
            .card-title {
                font-size: 1rem;
                font-weight: 600;
                color: #374151;
            }
            
            .card-brand {
                background: #2563eb;
                color: white;
                padding: 3px 8px;
                border-radius: 6px;
                font-size: 11px;
                font-weight: 600;
            }
            
            .card-detail {
                padding: 6px 0;
                border-bottom: 1px solid #f1f5f9;
            }
            
            .card-detail-label {
                font-size: 12px;
                color: #6b7280;
                font-weight: 500;
            }
            
            .card-detail-value {
                font-size: 13px;
                color: #374151;
                font-weight: 600;
            }
            
            .card-metrics {
                gap: 12px;
                margin-top: 12px;
            }
            
            .card-metric-value {
                font-size: 1.1rem;
                font-weight: 700;
                color: #2563eb;
            }
            
            .card-metric-label {
                font-size: 11px;
                color: #6b7280;
                text-transform: uppercase;
                letter-spacing: 0.5px;
                font-weight: 600;
            }
            
            .pagination {
                padding: 12px;
                flex-wrap: wrap;
                gap: 6px;
                margin: 12px;
                background: white;
                border-radius: 10px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
                border: 1px solid #e2e8f0;
            }
            
            .pagination button {
                padding: 10px 14px;
                font-size: 13px;
                border-radius: 6px;
                font-weight: 600;
                border: 2px solid #e2e8f0;
                background: white;
                color: #374151;
            }
            
            .pagination button:hover:not(:disabled) {
                background: #f8fafc;
                border-color: #2563eb;
                color: #2563eb;
            }
            
            .pagination .active {
                background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
                color: white;
                border-color: #2563eb;
            }
            
            .page-info {
                width: 100%;
                text-align: center;
                margin: 8px 0;
                order: 3;
                font-size: 13px;
                color: #64748b;
                font-weight: 500;
            }
            
            #pageSizeSelect {
                order: 2;
                padding: 10px 12px;
                font-size: 13px;
                border-radius: 6px;
                border: 2px solid #e2e8f0;
                background: white;
                font-weight: 500;
            }
            
            .analytics-page {
                padding: 16px;
                background: #f8fafc;
            }
            
            .analytics-header h2 {
                font-size: 1.75rem;
            }
            
            .analytics-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }
            
            .analytics-card {
                padding: 20px;
                border-radius: 12px;
            }
            
            .chart-container {
                height: 180px;
                padding: 12px 4px 4px 4px;
            }
            
            .chart-bar {
                min-width: 24px;
            }
            
            .chart-label {
                font-size: 10px;
            }
            
            .chart-value {
                font-size: 11px;
            }
            
            .pie-chart {
                width: 140px;
                height: 140px;
            }
            
            .pie-legend {
                gap: 8px;
            }
            
            .legend-item {
                font-size: 12px;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.375rem;
            }
            
            .header p {
                font-size: 0.8rem;
            }
            
            .nav-tab {
                padding: 12px 16px;
                font-size: 13px;
                min-width: 100px;
            }
            
            .controls {
                padding: 12px;
            }
            
            .search-box input {
                padding: 14px 14px 14px 44px;
                font-size: 16px;
            }
            
            .load-btn, .modal-btn {
                padding: 14px 18px;
                font-size: 14px;
            }
            
            .view-btn {
                padding: 10px 12px;
                font-size: 12px;
            }
            
            .stats {
                grid-template-columns: 1fr;
                gap: 10px;
                margin: 12px;
            }
            
            .stat-item {
                padding: 16px 14px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                text-align: left;
            }
            
            .stat-value {
                font-size: 1.5rem;
                margin-bottom: 0;
            }
            
            .stat-label {
                font-size: 0.75rem;
            }
            
            .table-container {
                margin: 12px;
            }
            
            table {
                font-size: 11px;
            }
            
            th, td {
                padding: 8px 4px;
                min-width: 70px;
            }
            
            .item-card {
                padding: 16px;
            }
            
            .card-title {
                font-size: 1rem;
            }
            
            .card-brand {
                font-size: 11px;
                padding: 3px 6px;
            }
            
            .card-metric-value {
                font-size: 1rem;
            }
            
            .card-metric-label {
                font-size: 11px;
            }
            
            .pagination {
                margin: 12px;
                padding: 12px;
            }
            
            .pagination button {
                padding: 10px 14px;
                font-size: 13px;
            }
            
            .analytics-card {
                padding: 16px;
            }
            
            .chart-container {
                height: 160px;
            }
            
            .analytics-header h2 {
                font-size: 1.5rem;
            }
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            border-radius: 16px;
            width: 95%;
            max-width: 1200px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.25);
            animation: slideIn 0.3s ease;
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 1.5rem;
            font-weight: 600;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.2s ease;
        }

        .modal-close:hover {
            background-color: rgba(255,255,255,0.2);
        }

        .modal-body {
            padding: 30px;
            max-height: calc(90vh - 80px);
            overflow-y: auto;
        }

        .modal-search {
            position: relative;
            margin-bottom: 25px;
        }

        .modal-search input {
            width: 100%;
            padding: 12px 16px 12px 45px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .modal-search input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .modal-search .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #64748b;
        }

        .view-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }

        .view-btn {
            padding: 10px 20px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .view-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .view-btn:hover:not(.active) {
            border-color: #667eea;
            color: #667eea;
        }

        .modal-table-container {
            overflow-x: auto;
            max-height: 60vh;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
        }

        .modal-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .modal-table th {
            background: #f8fafc;
            color: #374151;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e2e8f0;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .modal-table td {
            padding: 12px;
            border-bottom: 1px solid #f1f5f9;
        }

        .modal-table tr:hover {
            background-color: #f8fafc;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            max-height: 70vh;
            overflow-y: auto;
        }

        .cards-container {
            padding: 16px 20px;
            background: #f8fafc;
        }

        .cards-container .cards-grid {
            max-height: 70vh;
            overflow-y: auto;
            padding: 4px;
        }

        .item-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 28px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .item-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #2563eb 0%, #10b981 50%, #f59e0b 100%);
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .item-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(37, 99, 235, 0.08), transparent);
            transition: left 0.6s ease;
        }

        .item-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 48px rgba(0,0,0,0.2);
            border-color: rgba(102, 126, 234, 0.3);
            background: rgba(255, 255, 255, 0.98);
        }

        .item-card:hover::before {
            opacity: 1;
        }

        .item-card:hover::after {
            left: 100%;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #374151;
            margin: 0;
        }

        .card-brand {
            background: #2563eb;
            color: white;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 500;
        }

        .card-details {
            margin-bottom: 20px;
        }

        .card-detail {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .card-detail:last-child {
            border-bottom: none;
        }

        .card-detail-label {
            font-size: 14px;
            color: #6b7280;
            font-weight: 500;
        }

        .card-detail-value {
            font-size: 14px;
            color: #374151;
            font-weight: 500;
        }

        .card-metrics {
            display: flex;
            justify-content: space-between;
            gap: 15px;
        }

        .card-metric {
            text-align: center;
            flex: 1;
        }

        .card-metric-value {
            display: block;
            font-size: 1.2rem;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 4px;
        }

        .card-metric-label {
            font-size: 12px;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Detail Modal Styles */
        .detail-modal .modal-content {
            max-width: 800px;
        }

        .detail-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 12px;
        }

        .detail-icon {
            font-size: 3rem;
            background: #667eea;
            color: white;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .detail-title-section h3 {
            margin: 0 0 8px 0;
            font-size: 1.8rem;
            color: #374151;
            font-weight: 700;
        }

        .detail-subtitle {
            margin: 0;
            color: #6b7280;
            font-size: 1.1rem;
        }

        .detail-highlight {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 30px;
        }

        .detail-highlight h4 {
            margin: 0 0 10px 0;
            font-size: 1rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .detail-highlight .value {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 0;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }

        .detail-section {
            background: #f8fafc;
            padding: 25px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .detail-section h4 {
            margin: 0 0 20px 0;
            font-size: 1.1rem;
            color: #374151;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-field {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .detail-field:last-child {
            border-bottom: none;
        }

        .detail-field-label {
            font-size: 14px;
            color: #6b7280;
            font-weight: 500;
        }

        .detail-field-value {
            font-size: 14px;
            color: #374151;
            font-weight: 600;
            text-align: right;
        }

        /* Mobile Modal Styles */
        @media (max-width: 768px) {
            .modal-content {
                margin: 5% auto;
                width: 98%;
                max-height: 95vh;
            }

            .modal-header {
                padding: 15px 20px;
            }

            .modal-header h2 {
                font-size: 1.3rem;
            }

            .modal-body {
                padding: 20px;
            }

            .cards-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .item-card {
                padding: 15px;
            }

            .card-metrics {
                gap: 10px;
            }

            .detail-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
                padding: 20px;
            }

            .detail-icon {
                width: 60px;
                height: 60px;
                font-size: 2rem;
            }

            .detail-title-section h3 {
                font-size: 1.5rem;
            }

            .detail-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .detail-section {
                padding: 20px;
            }

            .detail-field {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }

            .detail-field-value {
                text-align: left;
                font-size: 16px;
            }

            .modal-table-container {
                max-height: 50vh;
            }

            .modal-table {
                font-size: 12px;
            }

            .modal-table th,
            .modal-table td {
                padding: 8px 6px;
                min-width: 80px;
            }
        }

        @media (max-width: 480px) {
            .modal-content {
                margin: 2% auto;
                width: 100%;
                border-radius: 0;
                max-height: 100vh;
            }

            .modal-header {
                padding: 12px 15px;
            }

            .modal-header h2 {
                font-size: 1.2rem;
            }

            .modal-body {
                padding: 15px;
            }

            .view-buttons {
                flex-direction: column;
                gap: 8px;
            }

            .view-btn {
                padding: 12px 16px;
                text-align: center;
            }

            .detail-highlight .value {
                font-size: 2rem;
            }

            .modal-table {
                font-size: 11px;
            }

            .modal-table th,
            .modal-table td {
                padding: 6px 4px;
                min-width: 70px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>Data Stok Cold Storage</h1>
                <p>Real-time data by PPIC</p>
                <div style="display: flex; justify-content: center; align-items: center; gap: 24px; margin-top: 12px; flex-wrap: wrap;">
                    <span id="recordInfo" style="font-size: 0.9rem; opacity: 0.9; color: #e2e8f0;">Click "Load Data" to fetch records</span>
                    <span id="lastModified" style="font-size: 0.9rem; opacity: 0.9; color: #cbd5e1;"> Checking last update...</span>
                </div>
            </div>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showPage('data')"> Data View</button>
            <button class="nav-tab" onclick="showPage('analytics')"> Analytics</button>
            <button class="nav-tab" onclick="showPage('quarantine')"> Karantina</button>
        </div>

        <div class="controls">
            <div class="search-box">
                <div class="search-icon"></div>
                <input type="text" id="searchInput" placeholder="Search by Product ID, Brand, Code, or any field...">
            </div>
            <div class="control-buttons">
                <button class="load-btn" id="loadBtn" onclick="loadData()">
                     Reload Data
                </button>
                <button class="view-btn active" onclick="switchDataView('table')" title="Table View">
                     Table
                </button>
                <button class="view-btn" onclick="switchDataView('cards')" title="Card View">
                     Cards
                </button>
                <button class="modal-btn" onclick="openTableModal()" title="Advanced Table View">
                     Advanced
                </button>
            </div>
        </div>

        <div class="filters" id="filters" style="display: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h4 style="margin: 0; color: #374151; font-size: 14px; font-weight: 600;"> Filters </h4>
                <button onclick="toggleFilters()" id="toggleFiltersBtn" style="background: none; border: 1px solid #d1d5db; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">
                     Show
                </button>
            </div>
            
            <div id="filtersContent" style="display: none;">
                <div class="filter-group">
                    <label class="filter-label">Brand</label>
                    <select class="filter-select" id="brandFilter">
                        <option value="">All Brands</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">Size</label>
                    <select class="filter-select" id="sizeFilter">
                        <option value="">All Sizes</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label class="filter-label">Actions</label>
                    <div style="display: flex; gap: 8px;">
                        <button class="clear-btn" onclick="clearFilters()">Clear Filters</button>
                        <button class="export-btn" onclick="exportToPDF()"> Export PDF</button>
                        <button class="export-btn" onclick="exportToExcel()" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); margin-left: 8px;"> Export Excel</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="status" id="status">
            Click "Load Data" to fetch the latest inventory information
        </div>

        <div class="stats" id="stats" style="display: none;">
            <div class="stat-item">
                <span class="stat-value" id="totalRows">0</span>
                <span class="stat-label">Total Items</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="totalQty">0</span>
                <span class="stat-label">Total Quantity</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="totalKg">0</span>
                <span class="stat-label">Total Weight (KG)</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="uniqueBrands">0</span>
                <span class="stat-label">Unique Brands</span>
            </div>
        </div>



        <div class="table-container" id="tableContainer" style="display: none;">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th onclick="sortTable('PRODUK ID')">Product ID <span class="sort-indicator" id="sort-PRODUK ID"></span></th>
                        <th onclick="sortTable('SIZE')">Size <span class="sort-indicator" id="sort-SIZE"></span></th>
                        <th onclick="sortTable('PO')">PO <span class="sort-indicator" id="sort-PO"></span></th>
                        <th onclick="sortTable('JD')">JD <span class="sort-indicator" id="sort-JD"></span></th>
                        <th onclick="sortTable('KODE')">Code <span class="sort-indicator" id="sort-KODE"></span></th>
                        <th onclick="sortTable('KODE ASAL')">Code Asal <span class="sort-indicator" id="sort-KODE ASAL"></span></th>
                        <th onclick="sortTable('PACKING')">Packing <span class="sort-indicator" id="sort-PACKING"></span></th>
                        <th onclick="sortTable('BRAND')">Brand <span class="sort-indicator" id="sort-BRAND"></span></th>
                        <th onclick="sortTable('TGL MSK')">Tgl Masuk <span class="sort-indicator" id="sort-TGL MSK"></span></th>
                        <th onclick="sortTable('QTY MASUK')">Qty Masuk <span class="sort-indicator" id="sort-QTY MASUK"></span></th>
                        <th onclick="sortTable('OFFSET')">Offset <span class="sort-indicator" id="sort-OFFSET"></span></th>
                        <th onclick="sortTable('SALDO')">Saldo <span class="sort-indicator" id="sort-SALDO"></span></th>
                        <th onclick="sortTable('KG')">KG <span class="sort-indicator" id="sort-KG"></span></th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>
        </div>

        <div class="cards-container" id="cardsContainer" style="display: none;">
            <div class="cards-grid" id="dataCardsGrid">
                <!-- Cards will be populated here -->
            </div>
        </div>

        <div class="pagination" id="pagination" style="display: none;">
            <button onclick="changePage(-1)" id="prevBtn"> Previous</button>
            <div class="page-info">
                <span id="pageInfo">Page 1 of 1</span>
            </div>
            <button onclick="changePage(1)" id="nextBtn">Next </button>
            <select id="pageSizeSelect" onchange="changePageSize()" style="margin-left: 20px; padding: 6px;">
                <option value="25">25 per page</option>
                <option value="50" selected>50 per page</option>
                <option value="100">100 per page</option>
                <option value="all">Show All</option>
            </select>
        </div>



        <div class="analytics-page" id="analyticsPage">
            <div class="analytics-header">
                <h2>Analytics</h2>
            </div>

            <div class="analytics-grid">
                <div class="analytics-card">
                    <h3> Qty by Brand</h3>
                    <div class="chart-container" id="brandChart">
                        <div style="text-align: center; color: #6b7280; margin-top: 100px;">
                            Load data to view brand distribution
                        </div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3> Top Products by Qty</h3>
                    <div class="top-items" id="topProducts">
                        <div style="text-align: center; color: #6b7280; padding: 50px 0;">
                            Load data to view top products
                        </div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3> Size Distribution</h3>
                    <div class="pie-chart" id="sizeChart" style="background: conic-gradient(#667eea 0deg 120deg, #764ba2 120deg 240deg, #f59e0b 240deg 360deg);">
                    </div>
                    <div class="pie-legend" id="sizeLegend">
                        <div style="text-align: center; color: #6b7280;">
                            Load data to view size distribution
                        </div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3> Daily Stock KG</h3>
                    <div class="chart-container" id="dailyKgChart">
                        <div style="text-align: center; color: #6b7280; margin-top: 100px;">
                            Load data to view daily KG trends
                        </div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3> Brand Performance</h3>
                    <div class="top-items" id="brandPerformance">
                        <div style="text-align: center; color: #6b7280; padding: 50px 0;">
                            Load data to view brand performance
                        </div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3> Packing Analysis</h3>
                    <div class="chart-container" id="packingChart">
                        <div style="text-align: center; color: #6b7280; margin-top: 100px;">
                            Load data to view packing distribution
                        </div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3> PO Performance</h3>
                    <div class="top-items" id="poPerformance">
                        <div style="text-align: center; color: #6b7280; padding: 50px 0;">
                            Load data to view PO performance
                        </div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3> Monthly Trends</h3>
                    <div class="chart-container" id="monthlyTrendsChart">
                        <div style="text-align: center; color: #6b7280; margin-top: 100px;">
                            Load data to view monthly trends
                        </div>
                    </div>
                </div>





                <div class="analytics-card">
                    <h3> Top Performing Codes</h3>
                    <div class="top-items" id="topCodes">
                        <div style="text-align: center; color: #6b7280; padding: 50px 0;">
                            Load data to view top performing codes
                        </div>
                    </div>
                </div>

                <div class="analytics-card">
                    <h3> Brands Distribution</h3>
                    <div class="distribution-chart" id="inventoryDistribution">
                        <div style="text-align: center; color: #6b7280; margin-top: 100px;">
                            Load data to view brands distribution
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="analytics-page" id="quarantinePage" style="display: none;">
            <div class="analytics-header">
                <h2> Karantina Management</h2>
                
            </div>

            <div class="quarantine-stats" style="display: flex; gap: 20px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center;">
                <div class="stat-item" style="background: #fef2f2; border: 2px solid #fecaca; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineTotal" style="color: #dc2626;">0</span>
                    <span class="stat-label" style="color: #991b1b;">Total Karantina</span>
                </div>
                <div class="stat-item" style="background: #fff7ed; border: 2px solid #fed7aa; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineQty" style="color: #ea580c;">0</span>
                    <span class="stat-label" style="color: #c2410c;">Total Quantity</span>
                </div>
                <div class="stat-item" style="background: #fefce8; border: 2px solid #fde047; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineWeight" style="color: #ca8a04;">0</span>
                    <span class="stat-label" style="color: #a16207;">Total Weight (KG)</span>
                </div>
            </div>

            <div class="quarantine-controls" style="padding: 20px; background: #fef2f2; border-radius: 12px; margin-bottom: 30px; border: 1px solid #fecaca;">
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div class="search-box" style="flex: 1; min-width: 250px;">
                        <div class="search-icon"></div>
                        <input type="text" id="quarantineSearchInput" placeholder="Search karantina items...">
                    </div>
                    <button class="export-btn" onclick="exportQuarantineReport()" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                         Export Karantina Report
                    </button>
                </div>
            </div>

            <div class="quarantine-table-container" style="background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden;">
                <div class="table-container" id="quarantineTableContainer">
                    <table id="quarantineTable">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                                <th style="color: white;">Product ID</th>
                                <th style="color: white;">Brand Status</th>
                                <th style="color: white;">Size</th>
                                <th style="color: white;">Code</th>
                                <th style="color: white;">Qty Masuk</th>
                                <th style="color: white;">Saldo</th>
                                <th style="color: white;">KG</th>
                                <th style="color: white;">Date Masuk</th>
                                <th style="color: white;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="quarantineTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="quarantine-empty" id="quarantineEmpty" style="display: none; text-align: center; padding: 60px 20px; color: #6b7280;">
                <div style="font-size: 4rem; margin-bottom: 20px;"></div>
                <h3 style="margin: 0 0 10px 0; color: #374151;">No Items in Quarantine</h3>
                <p style="margin: 0;">All items are in good status!</p>
            </div>
        </div>
    </div>

    <!-- Table Modal -->
    <div id="tableModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2> Advanced Table View</h2>
                <button class="modal-close" onclick="closeModal('tableModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-search">
                    <div class="search-icon"></div>
                    <input type="text" id="modalSearchInput" placeholder="Search in modal...">
                </div>
                
                <div class="view-buttons">
                    <button class="view-btn active" onclick="switchModalView('table')"> Table</button>
                    <button class="view-btn" onclick="switchModalView('summary')"> Summary</button>
                </div>

                <div id="modalTableView">
                    <div class="modal-table-container">
                        <table class="modal-table" id="modalTable">
                            <thead>
                                <tr>
                                    <th>Product ID</th>
                                    <th>Brand</th>
                                    <th>Size</th>
                                    <th>Code</th>
                                    <th>Qty Masuk</th>
                                    <th>Saldo</th>
                                    <th>KG</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="modalTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="modalSummaryView" style="display: none;">
                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h3> Quick Stats</h3>
                            <ul class="metric-list">
                                <li class="metric-item">
                                    <span class="metric-label">Total Items</span>
                                    <span class="metric-value" id="modalTotalItems">-</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-label">Total Quantity</span>
                                    <span class="metric-value" id="modalTotalQty">-</span>
                                </li>
                                <li class="metric-item">
                                    <span class="metric-label">Total Weight</span>
                                    <span class="metric-value" id="modalTotalWeight">-</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="analytics-page" id="quarantinePage" style="display: none;">
            <div class="analytics-header">
                <h2> Karantina Management</h2>
                <p>Items in quarantine status - requires special attention</p>
            </div>

            <div class="quarantine-stats" style="display: flex; gap: 20px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center;">
                <div class="stat-item" style="background: #fef2f2; border: 2px solid #fecaca; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineTotal" style="color: #dc2626;">0</span>
                    <span class="stat-label" style="color: #991b1b;">Total Karantina</span>
                </div>
                <div class="stat-item" style="background: #fff7ed; border: 2px solid #fed7aa; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineQty" style="color: #ea580c;">0</span>
                    <span class="stat-label" style="color: #c2410c;">Total Quantity</span>
                </div>
                <div class="stat-item" style="background: #fefce8; border: 2px solid #fde047; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineWeight" style="color: #ca8a04;">0</span>
                    <span class="stat-label" style="color: #a16207;">Total Weight (KG)</span>
                </div>
            </div>

            <div class="quarantine-controls" style="padding: 20px; background: #fef2f2; border-radius: 12px; margin-bottom: 30px; border: 1px solid #fecaca;">
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div class="search-box" style="flex: 1; min-width: 250px;">
                        <div class="search-icon"></div>
                        <input type="text" id="quarantineSearchInput" placeholder="Search karantina items...">
                    </div>
                    <button class="export-btn" onclick="exportQuarantineReport()" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                         Export Karantina Report
                    </button>
                </div>
            </div>

            <div class="quarantine-table-container" style="background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden;">
                <div class="table-container" id="quarantineTableContainer">
                    <table id="quarantineTable">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                                <th style="color: white;">Product ID</th>
                                <th style="color: white;">Brand Status</th>
                                <th style="color: white;">Size</th>
                                <th style="color: white;">Code</th>
                                <th style="color: white;">Qty Masuk</th>
                                <th style="color: white;">Saldo</th>
                                <th style="color: white;">KG</th>
                                <th style="color: white;">Date Masuk</th>
                                <th style="color: white;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="quarantineTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="quarantine-empty" id="quarantineEmpty" style="display: none; text-align: center; padding: 60px 20px; color: #6b7280;">
                <div style="font-size: 4rem; margin-bottom: 20px;"></div>
                <h3 style="margin: 0 0 10px 0; color: #374151;">No Items in Quarantine</h3>
                <p style="margin: 0;">All items are in good status!</p>
            </div>
        </div>
    </div>

    <!-- Card Modal -->
    <div id="cardModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2> Card View</h2>
                <button class="modal-close" onclick="closeModal('cardModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-search">
                    <div class="search-icon"></div>
                    <input type="text" id="cardModalSearchInput" placeholder="Search cards...">
                </div>
                
                <div class="cards-grid" id="cardsContainer">
                    <!-- Cards will be populated here -->
                </div>
            </div>
        </div>

        <div class="analytics-page" id="quarantinePage" style="display: none;">
            <div class="analytics-header">
                <h2> Karantina Management</h2>
                <p>Items in quarantine status - requires special attention</p>
            </div>

            <div class="quarantine-stats" style="display: flex; gap: 20px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center;">
                <div class="stat-item" style="background: #fef2f2; border: 2px solid #fecaca; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineTotal" style="color: #dc2626;">0</span>
                    <span class="stat-label" style="color: #991b1b;">Total Karantina</span>
                </div>
                <div class="stat-item" style="background: #fff7ed; border: 2px solid #fed7aa; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineQty" style="color: #ea580c;">0</span>
                    <span class="stat-label" style="color: #c2410c;">Total Quantity</span>
                </div>
                <div class="stat-item" style="background: #fefce8; border: 2px solid #fde047; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineWeight" style="color: #ca8a04;">0</span>
                    <span class="stat-label" style="color: #a16207;">Total Weight (KG)</span>
                </div>
            </div>

            <div class="quarantine-controls" style="padding: 20px; background: #fef2f2; border-radius: 12px; margin-bottom: 30px; border: 1px solid #fecaca;">
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div class="search-box" style="flex: 1; min-width: 250px;">
                        <div class="search-icon"></div>
                        <input type="text" id="quarantineSearchInput" placeholder="Search karantina items...">
                    </div>
                    <button class="export-btn" onclick="exportQuarantineReport()" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                         Export Karantina Report
                    </button>
                </div>
            </div>

            <div class="quarantine-table-container" style="background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden;">
                <div class="table-container" id="quarantineTableContainer">
                    <table id="quarantineTable">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                                <th style="color: white;">Product ID</th>
                                <th style="color: white;">Brand Status</th>
                                <th style="color: white;">Size</th>
                                <th style="color: white;">Code</th>
                                <th style="color: white;">Qty Masuk</th>
                                <th style="color: white;">Saldo</th>
                                <th style="color: white;">KG</th>
                                <th style="color: white;">Date Masuk</th>
                                <th style="color: white;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="quarantineTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="quarantine-empty" id="quarantineEmpty" style="display: none; text-align: center; padding: 60px 20px; color: #6b7280;">
                <div style="font-size: 4rem; margin-bottom: 20px;"></div>
                <h3 style="margin: 0 0 10px 0; color: #374151;">No Items in Quarantine</h3>
                <p style="margin: 0;">All items are in good status!</p>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div id="detailModal" class="modal detail-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2> Item Details</h2>
                <button class="modal-close" onclick="closeModal('detailModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-header">
                    <div class="detail-icon"></div>
                    <div class="detail-title-section">
                        <h3 id="detailTitle">Product Details</h3>
                        <p class="detail-subtitle" id="detailSubtitle">Complete information</p>
                    </div>
                </div>

                <div class="detail-highlight">
                    <h4>Current Stock Level</h4>
                    <p class="value" id="detailSaldo">-</p>
                </div>

                <div class="detail-grid">
                    <div class="detail-section">
                        <h4> Product Information</h4>
                        <div class="detail-field">
                            <span class="detail-field-label">Product ID</span>
                            <span class="detail-field-value" id="detailProductId">-</span>
                        </div>
                        <div class="detail-field">
                            <span class="detail-field-label">Brand</span>
                            <span class="detail-field-value" id="detailBrand">-</span>
                        </div>
                        <div class="detail-field">
                            <span class="detail-field-label">Size</span>
                            <span class="detail-field-value" id="detailSize">-</span>
                        </div>
                        <div class="detail-field">
                            <span class="detail-field-label">Code</span>
                            <span class="detail-field-value" id="detailCode">-</span>
                        </div>
                        <div class="detail-field">
                            <span class="detail-field-label">Code Asal</span>
                            <span class="detail-field-value" id="detailCodeAsal">-</span>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4> Inventory Details</h4>
                        <div class="detail-field">
                            <span class="detail-field-label">Quantity Masuk</span>
                            <span class="detail-field-value" id="detailQtyMasuk">-</span>
                        </div>
                        <div class="detail-field">
                            <span class="detail-field-label">Offset</span>
                            <span class="detail-field-value" id="detailOffset">-</span>
                        </div>
                        <div class="detail-field">
                            <span class="detail-field-label">Weight (KG)</span>
                            <span class="detail-field-value" id="detailKg">-</span>
                        </div>
                        <div class="detail-field">
                            <span class="detail-field-label">Packing</span>
                            <span class="detail-field-value" id="detailPacking">-</span>
                        </div>
                        <div class="detail-field">
                            <span class="detail-field-label">Date Masuk</span>
                            <span class="detail-field-value" id="detailTglMasuk">-</span>
                        </div>
                    </div>

                    <div class="detail-section">
                        <h4> PO & JD</h4>
                        <div class="detail-field">
                            <span class="detail-field-label">PO</span>
                            <span class="detail-field-value" id="detailPo">-</span>
                        </div>
                        <div class="detail-field">
                            <span class="detail-field-label">JD</span>
                            <span class="detail-field-value" id="detailJd">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="analytics-page" id="quarantinePage" style="display: none;">
            <div class="analytics-header">
                <h2> Karantina Management</h2>
                <p>Items in quarantine status - requires special attention</p>
            </div>

            <div class="quarantine-stats" style="display: flex; gap: 20px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center;">
                <div class="stat-item" style="background: #fef2f2; border: 2px solid #fecaca; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineTotal" style="color: #dc2626;">0</span>
                    <span class="stat-label" style="color: #991b1b;">Total Karantina</span>
                </div>
                <div class="stat-item" style="background: #fff7ed; border: 2px solid #fed7aa; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineQty" style="color: #ea580c;">0</span>
                    <span class="stat-label" style="color: #c2410c;">Total Quantity</span>
                </div>
                <div class="stat-item" style="background: #fefce8; border: 2px solid #fde047; border-radius: 12px; padding: 20px; min-width: 150px;">
                    <span class="stat-value" id="quarantineWeight" style="color: #ca8a04;">0</span>
                    <span class="stat-label" style="color: #a16207;">Total Weight (KG)</span>
                </div>
            </div>

            <div class="quarantine-controls" style="padding: 20px; background: #fef2f2; border-radius: 12px; margin-bottom: 30px; border: 1px solid #fecaca;">
                <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                    <div class="search-box" style="flex: 1; min-width: 250px;">
                        <div class="search-icon"></div>
                        <input type="text" id="quarantineSearchInput" placeholder="Search karantina items...">
                    </div>
                    <button class="export-btn" onclick="exportQuarantineReport()" style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                         Export Karantina Report
                    </button>
                </div>
            </div>

            <div class="quarantine-table-container" style="background: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden;">
                <div class="table-container" id="quarantineTableContainer">
                    <table id="quarantineTable">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                                <th style="color: white;">Product ID</th>
                                <th style="color: white;">Brand Status</th>
                                <th style="color: white;">Size</th>
                                <th style="color: white;">Code</th>
                                <th style="color: white;">Qty Masuk</th>
                                <th style="color: white;">Saldo</th>
                                <th style="color: white;">KG</th>
                                <th style="color: white;">Date Masuk</th>
                                <th style="color: white;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="quarantineTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="quarantine-empty" id="quarantineEmpty" style="display: none; text-align: center; padding: 60px 20px; color: #6b7280;">
                <div style="font-size: 4rem; margin-bottom: 20px;"></div>
                <h3 style="margin: 0 0 10px 0; color: #374151;">No Items in Quarantine</h3>
                <p style="margin: 0;">All items are in good status!</p>
            </div>
        </div>
    </div>

    <script>
        const API_KEY = "AIzaSyBhiKDVDH4fle5_EqAIaA05YjpxVMEBYZM";
        const SHEET_ID = "1dgXDpt3MTdpHZyhhY7VdKC3tT_EQJaqoBBb0VFXwJco";
        const SHEET_NAME = "DETAIL";
        
        // Get last modified time from Drive API
        async function getLastModified() {
            try {
                const url = `https://www.googleapis.com/drive/v3/files/${SHEET_ID}?fields=modifiedTime,name&key=${API_KEY}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                const modifiedTime = new Date(data.modifiedTime);
                const now = new Date();
                const diffMinutes = Math.floor((now - modifiedTime) / (1000 * 60));
                
                let timeText;
                if (diffMinutes < 1) {
                    timeText = 'Just now';
                } else if (diffMinutes < 60) {
                    timeText = `${diffMinutes} minutes ago`;
                } else if (diffMinutes < 1440) {
                    const hours = Math.floor(diffMinutes / 60);
                    timeText = `${hours} hour${hours > 1 ? 's' : ''} ago`;
                } else {
                    const days = Math.floor(diffMinutes / 1440);
                    timeText = `${days} day${days > 1 ? 's' : ''} ago`;
                }
                
                document.getElementById('lastModified').innerHTML = ` Last updated: ${timeText}`;
                document.getElementById('lastModified').style.color = '#10b981';
                
            } catch (error) {
                console.error(' Error getting last modified time:', error);
                document.getElementById('lastModified').innerHTML = ' Update time unavailable';
                document.getElementById('lastModified').style.color = '#ef4444';
            }
        }

        // Validate API connection
        async function validateConnection() {
            try {
                const testUrl = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}?key=${API_KEY}`;
                const response = await fetch(testUrl);
                
                if (!response.ok) {
                    throw new Error(`API connection failed: ${response.status}`);
                }
                
                console.log(' API connection validated successfully');
                return true;
            } catch (error) {
                console.error(' API validation failed:', error);
                return false;
            }
        }
        
        let allData = [];
        let filteredData = [];
        let quarantineData = [];
        let filteredQuarantineData = [];
        let currentPage = 1;
        let pageSize = 50;
        let sortColumn = '';
        let sortDirection = 'asc';

        // Column mapping - Updated for current sheet structure
        // Let's check the actual sheet structure first and map accordingly
        const COLUMNS = {
            'PRODUK ID': 4,    // Column E (PRODUK ID)
            'SIZE': 6,         // Column G (SIZE)  
            'PO': 7,           // Column H (PO)
            'JD': 8,           // Column I (JD)
            'KODE': 9,         // Column J (KODE)
            'KODE ASAL': 10,   // Column K (KODE ASAL)
            'PACKING': 11,     // Column L (PACKING)
            'BRAND': 12,       // Column M (BRAND)
            'TGL MSK': 14,     // Column O (TGL MSK)
            'QTY MASUK': 15,   // Column P (QTY MASUK)
            'OFFSET': 47,      // Column AV (OFFSET)
            'SALDO': 48,       // Column AW (SALDO)
            'KG': 52           // Column BA (KG)
        };

        async function loadData() {
            const loadBtn = document.getElementById('loadBtn');
            const status = document.getElementById('status');
            const tableContainer = document.getElementById('tableContainer');
            const statsElement = document.querySelector('.stats');

            loadBtn.disabled = true;
            loadBtn.innerHTML = '<div class="loading-spinner"></div>Syncing Data...';
            status.className = 'status loading';
            status.textContent = ' Synchronizing with Google Sheets...';

            try {
                // Get all data from the sheet with expanded range
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${SHEET_NAME}!A:BZ?key=${API_KEY}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status} - ${response.statusText}`);
                }
                
                const data = await response.json();
                
                if (!data.values || data.values.length === 0) {
                    throw new Error('No data found in the spreadsheet');
                }

                console.log(' Sheet Structure Analysis:');
                console.log('Headers (Row 1):', data.values[0]);
                console.log('Sample Data (Row 2):', data.values[1]);
                console.log('Total Rows:', data.values.length);
                console.log('Total Columns:', data.values[0]?.length || 0);

                // Auto-detect column positions
                const headers = data.values[0] || [];
                const detectedColumns = {};
                
                // Map column names to their positions
                const columnMappings = {
                    'PRODUK ID': ['PRODUK ID', 'PRODUCT ID', 'ID PRODUK'],
                    'SIZE': ['SIZE', 'UKURAN'],
                    'PO': ['PO', 'PURCHASE ORDER'],
                    'JD': ['JD', 'JADWAL'],
                    'KODE': ['KODE', 'CODE'],
                    'KODE ASAL': ['KODE ASAL', 'ORIGINAL CODE'],
                    'PACKING': ['PACKING', 'KEMASAN'],
                    'BRAND': ['BRAND', 'MEREK'],
                    'TGL MSK': ['TGL MSK', 'TGL MASUK', 'DATE IN'],
                    'QTY MASUK': ['QTY MASUK', 'QUANTITY IN', 'QTY IN'],
                    'OFFSET': ['OFFSET'],
                    'SALDO': ['SALDO', 'BALANCE'],
                    'KG': ['KG', 'WEIGHT', 'BERAT']
                };

                // Auto-detect columns
                Object.keys(columnMappings).forEach(key => {
                    const possibleNames = columnMappings[key];
                    for (let i = 0; i < headers.length; i++) {
                        const header = (headers[i] || '').toString().toUpperCase().trim();
                        if (possibleNames.some(name => header.includes(name))) {
                            detectedColumns[key] = i;
                            break;
                        }
                    }
                });

                console.log(' Detected Columns:', detectedColumns);

                // Update global COLUMNS object
                Object.assign(COLUMNS, detectedColumns);

                allData = processData(data.values);
                filteredData = [...allData];
                
                console.log(' Processed Data:', {
                    totalRecords: allData.length,
                    sampleRecord: allData[0],
                    columnCount: Object.keys(COLUMNS).length
                });
                
                // Process quarantine data
                quarantineData = allData.filter(row => {
                    const brand = row['BRAND'] || '';
                    return brand.toLowerCase().includes('karantina') || 
                           brand.toLowerCase().includes('quarantine');
                });
                filteredQuarantineData = [...quarantineData];
                
                console.log(' Quarantine Data:', quarantineData.length, 'items found');
                
                populateFilters();
                displayData(filteredData);
                updateStats(filteredData);
                updateQuarantineStats();
                
                status.style.display = 'none';
                document.getElementById('recordInfo').textContent = ` ${allData.length.toLocaleString()} records loaded`;
                document.getElementById('filters').style.display = 'flex';
                
                // Show appropriate view
                if (currentDataView === 'table') {
                    tableContainer.style.display = 'block';
                    document.getElementById('cardsContainer').style.display = 'none';
                } else {
                    tableContainer.style.display = 'none';
                    document.getElementById('cardsContainer').style.display = 'block';
                }
                
                document.getElementById('pagination').style.display = 'flex';
                if (statsElement) statsElement.style.display = 'grid';

            } catch (error) {
                console.error(' Sync Error:', error);
                status.className = 'status error';
                status.textContent = ` Sync failed: ${error.message}`;
                tableContainer.style.display = 'none';
                document.getElementById('cardsContainer').style.display = 'none';
                if (statsElement) statsElement.style.display = 'none';
            } finally {
                loadBtn.disabled = false;
                loadBtn.innerHTML = ' Reload Data';
                getLastModified(); // Refresh last modified time after loading
            }
        }

        function processData(rawData) {
            console.log(' Processing raw data...');
            
            // Skip header row and process data
            const processedData = rawData.slice(1).map((row, index) => {
                const processedRow = {};
                
                // Extract only the columns we need
                Object.keys(COLUMNS).forEach(columnName => {
                    const columnIndex = COLUMNS[columnName];
                    if (columnIndex !== undefined && columnIndex < row.length) {
                        let value = row[columnIndex] || '';
                        
                        // Clean and format the value
                        if (typeof value === 'string') {
                            value = value.toString().trim();
                        }
                        
                        processedRow[columnName] = value;
                    } else {
                        processedRow[columnName] = '';
                    }
                });
                
                processedRow.originalIndex = index + 2; // +2 because we skip header and arrays are 0-indexed
                return processedRow;
            }).filter(row => {
                // Filter out completely empty rows
                const hasData = Object.values(row).some(value => 
                    value && value.toString().trim() !== '' && value !== 'originalIndex'
                );
                
                // Also check if at least PRODUK ID or BRAND exists
                const hasKey = row['PRODUK ID'] || row['BRAND'] || row['KODE'];
                
                return hasData && hasKey;
            });
            
            console.log(' Data processing complete:', {
                originalRows: rawData.length - 1,
                processedRows: processedData.length,
                filteredOut: (rawData.length - 1) - processedData.length
            });
            
            return processedData;
        }

        let currentDataView = 'table';

        function switchDataView(view) {
            const tableContainer = document.getElementById('tableContainer');
            const cardsContainer = document.getElementById('cardsContainer');
            const viewButtons = document.querySelectorAll('.view-btn');
            
            // Update button states
            viewButtons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            currentDataView = view;
            
            if (view === 'table') {
                tableContainer.style.display = 'block';
                cardsContainer.style.display = 'none';
            } else {
                tableContainer.style.display = 'none';
                cardsContainer.style.display = 'block';
            }
            
            // Refresh display with current data
            if (filteredData.length > 0) {
                displayData(filteredData);
            }
        }

        function displayData(data) {
            if (currentDataView === 'table') {
                displayTableData(data);
            } else {
                displayCardData(data);
            }
        }

        function displayTableData(data) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';

            // Calculate pagination
            const totalPages = pageSize === 'all' ? 1 : Math.ceil(data.length / pageSize);
            const startIndex = pageSize === 'all' ? 0 : (currentPage - 1) * pageSize;
            const endIndex = pageSize === 'all' ? data.length : startIndex + pageSize;
            const paginatedData = data.slice(startIndex, endIndex);

            paginatedData.forEach(row => {
                const tr = document.createElement('tr');
                tr.style.cursor = 'pointer';
                tr.onclick = () => openDetailModal(row);
                
                // Create cells for each column
                Object.keys(COLUMNS).forEach(columnName => {
                    const td = document.createElement('td');
                    let value = row[columnName] || '';
                    
                    // Apply special formatting based on column type
                    if (['QTY MASUK', 'OFFSET', 'SALDO', 'KG'].includes(columnName)) {
                        td.className = 'numeric';
                        if (value && !isNaN(value)) {
                            const numValue = parseFloat(value);
                            value = numValue.toLocaleString();
                            
                            td.textContent = value;
                        } else {
                            td.textContent = value;
                        }
                    } else if (columnName === 'BRAND') {
                        td.className = 'brand-cell';
                        td.textContent = value;
                    } else if (columnName === 'TGL MSK') {
                        td.className = 'date-cell';
                        td.textContent = value;
                    } else if (['KODE', 'KODE ASAL', 'PRODUK ID'].includes(columnName)) {
                        td.className = 'code-cell';
                        td.textContent = value;
                    } else {
                        td.textContent = value || '-';
                    }
                    
                    tr.appendChild(td);
                });
                
                tableBody.appendChild(tr);
            });

            // Update pagination info
            updatePaginationInfo(data.length, totalPages);
        }

        function displayCardData(data) {
            const cardsGrid = document.getElementById('dataCardsGrid');
            cardsGrid.innerHTML = '';

            // Calculate pagination
            const totalPages = pageSize === 'all' ? 1 : Math.ceil(data.length / pageSize);
            const startIndex = pageSize === 'all' ? 0 : (currentPage - 1) * pageSize;
            const endIndex = pageSize === 'all' ? data.length : startIndex + pageSize;
            const paginatedData = data.slice(startIndex, endIndex);

            paginatedData.forEach(row => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.onclick = () => openDetailModal(row);
                
                card.innerHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${row['PRODUK ID'] || 'N/A'}</h3>
                        <span class="card-brand">${row['BRAND'] || 'Unknown'}</span>
                    </div>
                    
                    <div class="card-details">
                        <div class="card-detail">
                            <span class="card-detail-label">Size</span>
                            <span class="card-detail-value">${row['SIZE'] || '-'}</span>
                        </div>
                        <div class="card-detail">
                            <span class="card-detail-label">Packing</span>
                            <span class="card-detail-value">${row['PACKING'] || '-'}</span>
                        </div>
                        <div class="card-detail">
                            <span class="card-detail-label">Code</span>
                            <span class="card-detail-value">${row['KODE'] || '-'}</span>
                        </div>
                        <div class="card-detail">
                            <span class="card-detail-label">PO</span>
                            <span class="card-detail-value">${row['PO'] || '-'}</span>
                        </div>
                        <div class="card-detail">
                            <span class="card-detail-label">Date</span>
                            <span class="card-detail-value">${row['TGL MSK'] || '-'}</span>
                        </div>
                    </div>
                    
                    <div class="card-metrics">
                        <div class="card-metric">
                            <span class="card-metric-value">${row['QTY MASUK'] ? parseFloat(row['QTY MASUK']).toLocaleString() : '0'}</span>
                            <span class="card-metric-label">Qty Masuk</span>
                        </div>
                        <div class="card-metric">
                            <span class="card-metric-value">${row['SALDO'] ? parseFloat(row['SALDO']).toLocaleString() : '0'}</span>
                            <span class="card-metric-label">Saldo</span>
                        </div>
                        <div class="card-metric">
                            <span class="card-metric-value">${row['KG'] ? parseFloat(row['KG']).toLocaleString() : '0'}</span>
                            <span class="card-metric-label">KG</span>
                        </div>
                    </div>
                `;
                
                cardsGrid.appendChild(card);
            });

            // Update pagination info
            updatePaginationInfo(data.length, totalPages);
        }

        function updateStats(data) {
            const totalRows = data.length;
            let totalQty = 0;
            let totalKg = 0;
            const uniqueBrands = new Set();

            data.forEach(row => {
                const qty = parseFloat(row['QTY MASUK']) || 0;
                const kg = parseFloat(row['KG']) || 0;
                
                totalQty += qty;
                totalKg += kg;
                
                if (row['BRAND']) {
                    uniqueBrands.add(row['BRAND']);
                }
            });

            document.getElementById('totalRows').textContent = totalRows.toLocaleString();
            document.getElementById('totalQty').textContent = totalQty.toLocaleString();
            document.getElementById('totalKg').textContent = totalKg.toLocaleString();
            document.getElementById('uniqueBrands').textContent = uniqueBrands.size.toLocaleString();
        }

        // Populate filter dropdowns
        function populateFilters() {
            const brands = [...new Set(allData.map(row => row['BRAND']).filter(brand => brand))].sort();
            const sizes = [...new Set(allData.map(row => row['SIZE']).filter(size => size))].sort();
            
            const brandFilter = document.getElementById('brandFilter');
            const sizeFilter = document.getElementById('sizeFilter');
            
            brandFilter.innerHTML = '<option value="">All Brands</option>';
            sizeFilter.innerHTML = '<option value="">All Sizes</option>';
            
            brands.forEach(brand => {
                brandFilter.innerHTML += `<option value="${brand}">${brand}</option>`;
            });
            
            sizes.forEach(size => {
                sizeFilter.innerHTML += `<option value="${size}">${size}</option>`;
            });
        }

        // Apply filters
        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            const brandFilter = document.getElementById('brandFilter').value;
            const sizeFilter = document.getElementById('sizeFilter').value;
            
            filteredData = allData.filter(row => {
                // Search filter
                const matchesSearch = searchTerm === '' || Object.values(row).some(value => 
                    value && value.toString().toLowerCase().includes(searchTerm)
                );
                
                // Brand filter
                const matchesBrand = brandFilter === '' || row['BRAND'] === brandFilter;
                
                // Size filter
                const matchesSize = sizeFilter === '' || row['SIZE'] === sizeFilter;
                
                return matchesSearch && matchesBrand && matchesSize;
            });
            
            currentPage = 1; // Reset to first page
            displayData(filteredData);
            updateStats(filteredData);
        }

        // Clear all filters
        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('brandFilter').value = '';
            document.getElementById('sizeFilter').value = '';
            
            filteredData = [...allData];
            currentPage = 1;
            displayData(filteredData);
            updateStats(filteredData);
        }

        // Sort table
        function sortTable(column) {
            if (sortColumn === column) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortColumn = column;
                sortDirection = 'asc';
            }
            
            // Update sort indicators
            document.querySelectorAll('.sort-indicator').forEach(indicator => {
                indicator.className = 'sort-indicator';
                indicator.textContent = '';
            });
            
            const currentIndicator = document.getElementById(`sort-${column}`);
            currentIndicator.className = 'sort-indicator active';
            currentIndicator.textContent = sortDirection === 'asc' ? '' : '';
            
            filteredData.sort((a, b) => {
                let aVal = a[column] || '';
                let bVal = b[column] || '';
                
                // Handle numeric columns
                if (['QTY MASUK', 'OFFSET', 'SALDO', 'KG'].includes(column)) {
                    aVal = parseFloat(aVal) || 0;
                    bVal = parseFloat(bVal) || 0;
                } else {
                    aVal = aVal.toString().toLowerCase();
                    bVal = bVal.toString().toLowerCase();
                }
                
                if (aVal < bVal) return sortDirection === 'asc' ? -1 : 1;
                if (aVal > bVal) return sortDirection === 'asc' ? 1 : -1;
                return 0;
            });
            
            currentPage = 1;
            displayData(filteredData);
        }

        // Pagination functions
        function updatePaginationInfo(totalItems, totalPages) {
            const pageInfo = document.getElementById('pageInfo');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            if (pageSize === 'all') {
                pageInfo.textContent = `Showing all ${totalItems} items`;
                prevBtn.disabled = true;
                nextBtn.disabled = true;
            } else {
                const startItem = (currentPage - 1) * pageSize + 1;
                const endItem = Math.min(currentPage * pageSize, totalItems);
                pageInfo.textContent = `Showing ${startItem}-${endItem} of ${totalItems} items (Page ${currentPage} of ${totalPages})`;
                
                prevBtn.disabled = currentPage === 1;
                nextBtn.disabled = currentPage === totalPages || totalPages === 0;
            }
        }

        function changePage(direction) {
            const totalPages = Math.ceil(filteredData.length / pageSize);
            const newPage = currentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                displayData(filteredData);
            }
        }

        function changePageSize() {
            const newPageSize = document.getElementById('pageSizeSelect').value;
            pageSize = newPageSize === 'all' ? 'all' : parseInt(newPageSize);
            currentPage = 1;
            displayData(filteredData);
        }

        // Export to PDF
        function exportToPDF() {
            const headers = Object.keys(COLUMNS);
            const currentDate = new Date().toLocaleDateString();
            
            // Create PDF content
            let pdfContent = `
                <html>
                <head>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .header h1 { color: #374151; margin: 0; }
                        .header p { color: #6b7280; margin: 5px 0; }
                        table { width: 100%; border-collapse: collapse; font-size: 12px; }
                        th, td { border: 1px solid #e5e7eb; padding: 8px; text-align: left; }
                        th { background: #f3f4f6; font-weight: bold; }
                        tr:nth-child(even) { background: #f9fafb; }
                        .numeric { text-align: right; }
                        .footer { margin-top: 20px; text-align: center; font-size: 10px; color: #6b7280; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1> Inventory Report</h1>
                        <p>Generated on ${currentDate}</p>
                        <p>Total Records: ${filteredData.length}</p>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                ${headers.map(header => `<th>${header}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${filteredData.map(row => `
                                <tr>
                                    ${headers.map(header => {
                                        const value = row[header] || '-';
                                        const isNumeric = ['QTY MASUK', 'OFFSET', 'SALDO', 'KG'].includes(header);
                                        return `<td class="${isNumeric ? 'numeric' : ''}">${value}</td>`;
                                    }).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    <div class="footer">
                        <p>Data Stok CS - Real-time data from PPIC</p>
                    </div>
                </body>
                </html>
            `;
            
            // Create and download PDF
            const printWindow = window.open('', '_blank');
            printWindow.document.write(pdfContent);
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 250);
        }

        // Export to Excel
        function exportToExcel() {
            const headers = Object.keys(COLUMNS);
            const currentDate = new Date().toISOString().split('T')[0];
            
            // Create Excel-compatible HTML table
            let excelContent = `
                <html>
                <head>
                    <meta charset="utf-8">
                    <style>
                        table { border-collapse: collapse; width: 100%; }
                        th, td { border: 1px solid #000; padding: 8px; text-align: left; }
                        th { background-color: #f0f0f0; font-weight: bold; }
                        .numeric { text-align: right; }
                    </style>
                </head>
                <body>
                    <h2>Inventory Report - ${currentDate}</h2>
                    <p>Total Records: ${filteredData.length}</p>
                    <table>
                        <thead>
                            <tr>
                                ${headers.map(header => `<th>${header}</th>`).join('')}
                            </tr>
                        </thead>
                        <tbody>
                            ${filteredData.map(row => `
                                <tr>
                                    ${headers.map(header => {
                                        const value = row[header] || '';
                                        const isNumeric = ['QTY MASUK', 'OFFSET', 'SALDO', 'KG'].includes(header);
                                        return `<td class="${isNumeric ? 'numeric' : ''}">${value}</td>`;
                                    }).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </body>
                </html>
            `;
            
            // Create blob and download
            const blob = new Blob([excelContent], { 
                type: 'application/vnd.ms-excel;charset=utf-8;' 
            });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `inventory_data_${currentDate}.xls`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', applyFilters);
        
        // Page navigation
        function showPage(page) {
            const dataElements = ['filters', 'tableContainer', 'cardsContainer', 'pagination', 'stats'];
            const analyticsElements = ['analyticsPage'];
            const quarantineElements = ['quarantinePage'];
            
            // Update tab states
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            if (page === 'data') {
                dataElements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element && allData.length > 0) {
                        if (id === 'filters' || id === 'stats') {
                            element.style.display = 'flex';
                        } else if (id === 'tableContainer') {
                            element.style.display = currentDataView === 'table' ? 'block' : 'none';
                        } else if (id === 'cardsContainer') {
                            element.style.display = currentDataView === 'cards' ? 'block' : 'none';
                        } else {
                            element.style.display = 'block';
                        }
                    }
                });
                analyticsElements.forEach(id => {
                    document.getElementById(id).style.display = 'none';
                });
                quarantineElements.forEach(id => {
                    document.getElementById(id).style.display = 'none';
                });
            } else if (page === 'analytics') {
                dataElements.forEach(id => {
                    document.getElementById(id).style.display = 'none';
                });
                analyticsElements.forEach(id => {
                    document.getElementById(id).style.display = 'block';
                });
                quarantineElements.forEach(id => {
                    document.getElementById(id).style.display = 'none';
                });
                if (allData.length > 0) {
                    generateAnalytics();
                }
            } else if (page === 'quarantine') {
                dataElements.forEach(id => {
                    document.getElementById(id).style.display = 'none';
                });
                analyticsElements.forEach(id => {
                    document.getElementById(id).style.display = 'none';
                });
                quarantineElements.forEach(id => {
                    document.getElementById(id).style.display = 'block';
                });
                if (allData.length > 0) {
                    displayQuarantineData();
                }
            }
        }

        // Generate analytics
        function generateAnalytics() {
            generateBrandChart();
            generateTopProducts();
            generateSizeDistribution();
            generateDailyKgChart();
            generateBrandPerformance();
            generatePackingAnalysis();
            generatePOPerformance();
            generateMonthlyTrends();
            generateTopCodes();
            generateInventoryDistribution();
        }

        function generateBrandChart() {
            const brandData = {};
            allData.forEach(row => {
                const brand = row['BRAND'] || 'Unknown';
                const qty = parseFloat(row['QTY MASUK']) || 0;
                brandData[brand] = (brandData[brand] || 0) + qty;
            });

            const sortedBrands = Object.entries(brandData)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 8);

            const maxValue = Math.max(...sortedBrands.map(([,value]) => value));
            
            const chartContainer = document.getElementById('brandChart');
            chartContainer.innerHTML = '';

            sortedBrands.forEach(([brand, value]) => {
                const height = (value / maxValue) * 200;
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = height + 'px';
                bar.innerHTML = `
                    <div class="chart-value">${value.toLocaleString()}</div>
                    <div class="chart-label">${brand.length > 8 ? brand.substring(0, 8) + '...' : brand}</div>
                `;
                chartContainer.appendChild(bar);
            });
        }

        function generateTopProducts() {
            // Group by unique combination of PRODUK ID + PACKING + BRAND
            const productGroups = {};
            
            allData.forEach(row => {
                const productId = row['PRODUK ID'] || 'N/A';
                const packing = row['PACKING'] || 'N/A';
                const brand = row['BRAND'] || 'Unknown';
                const uniqueKey = `${productId}|${packing}|${brand}`;
                
                if (!productGroups[uniqueKey]) {
                    productGroups[uniqueKey] = {
                        id: productId,
                        packing: packing,
                        brand: brand,
                        totalQty: 0,
                        totalSaldo: 0,
                        totalKg: 0,
                        items: 0,
                        sizes: new Set()
                    };
                }
                
                productGroups[uniqueKey].totalQty += parseFloat(row['QTY MASUK']) || 0;
                productGroups[uniqueKey].totalSaldo += parseFloat(row['SALDO']) || 0;
                productGroups[uniqueKey].totalKg += parseFloat(row['KG']) || 0;
                productGroups[uniqueKey].items += 1;
                if (row['SIZE']) {
                    productGroups[uniqueKey].sizes.add(row['SIZE']);
                }
            });

            // Sort by total quantity and get top 10
            const topProducts = Object.values(productGroups)
                .sort((a, b) => b.totalQty - a.totalQty)
                .slice(0, 10);

            const container = document.getElementById('topProducts');
            container.innerHTML = '';

            topProducts.forEach((product, index) => {
                const sizesText = Array.from(product.sizes).join(', ') || 'N/A';
                const item = document.createElement('div');
                item.className = 'top-item';
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-name">#${index + 1} ${product.id}</div>
                        <div class="item-details">${product.brand}  ${product.packing}  ${product.items} variants</div>
                        <div class="item-details" style="font-size: 11px; color: #9ca3af;">Sizes: ${sizesText}</div>
                    </div>
                    <div class="item-value">${product.totalQty.toLocaleString()}</div>
                `;
                container.appendChild(item);
            });
        }

        function generateSizeDistribution() {
            const sizeData = {};
            allData.forEach(row => {
                const size = row['SIZE'] || 'Unknown';
                sizeData[size] = (sizeData[size] || 0) + 1;
            });

            const sortedSizes = Object.entries(sizeData)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 5);

            const total = sortedSizes.reduce((sum, [,count]) => sum + count, 0);
            const colors = ['#2563eb', '#1d4ed8', '#10b981', '#f59e0b', '#ef4444'];
            
            let currentAngle = 0;
            let gradientParts = [];

            sortedSizes.forEach(([size, count], index) => {
                const percentage = (count / total) * 100;
                const angle = (count / total) * 360;
                
                gradientParts.push(`${colors[index]} ${currentAngle}deg ${currentAngle + angle}deg`);
                currentAngle += angle;
            });

            const chart = document.getElementById('sizeChart');
            chart.style.background = `conic-gradient(${gradientParts.join(', ')})`;

            const legend = document.getElementById('sizeLegend');
            legend.innerHTML = '';

            sortedSizes.forEach(([size, count], index) => {
                const percentage = ((count / total) * 100).toFixed(1);
                const legendItem = document.createElement('div');
                legendItem.className = 'legend-item';
                legendItem.innerHTML = `
                    <div class="legend-color" style="background: ${colors[index]}"></div>
                    <span>${size}: ${percentage}%</span>
                `;
                legend.appendChild(legendItem);
            });
        }

        // Daily KG Chart
        function generateDailyKgChart() {
            const dailyKgData = {};
            
            allData.forEach(row => {
                const dateStr = row['TGL MSK'] || '';
                if (dateStr) {
                    try {
                        let date;
                        if (dateStr.includes('/')) {
                            const parts = dateStr.split('/');
                            if (parts.length === 3) {
                                date = new Date(parts[2], parts[1] - 1, parts[0]);
                            }
                        } else if (dateStr.includes('-')) {
                            date = new Date(dateStr);
                        }
                        
                        if (date && !isNaN(date)) {
                            const dayKey = date.toISOString().split('T')[0];
                            const kg = parseFloat(row['KG']) || 0;
                            
                            if (!dailyKgData[dayKey]) {
                                dailyKgData[dayKey] = 0;
                            }
                            dailyKgData[dayKey] += kg;
                        }
                    } catch (e) {
                        // Skip invalid dates
                    }
                }
            });

            const sortedDays = Object.entries(dailyKgData)
                .sort(([a], [b]) => new Date(b) - new Date(a))
                .slice(0, 7)
                .reverse();

            const chartContainer = document.getElementById('dailyKgChart');
            chartContainer.innerHTML = '';

            if (sortedDays.length === 0) {
                chartContainer.innerHTML = '<div style="text-align: center; color: #6b7280; margin-top: 100px;">No date data available</div>';
                return;
            }

            const maxValue = Math.max(...sortedDays.map(([, kg]) => kg));

            sortedDays.forEach(([date, kg]) => {
                const height = maxValue > 0 ? (kg / maxValue) * 200 : 0;
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = height + 'px';
                
                const dateObj = new Date(date);
                const dayLabel = dateObj.toLocaleDateString('id-ID', { 
                    month: 'short', 
                    day: 'numeric' 
                });
                
                bar.innerHTML = `
                    <div class="chart-value">${kg.toLocaleString()} kg</div>
                    <div class="chart-label">${dayLabel}</div>
                `;
                chartContainer.appendChild(bar);
            });
        }



        // Packing Analysis
        function generatePackingAnalysis() {
            const packingData = {};
            allData.forEach(row => {
                const packing = row['PACKING'] || 'Unknown';
                const qty = parseFloat(row['QTY MASUK']) || 0;
                packingData[packing] = (packingData[packing] || 0) + qty;
            });

            const sortedPacking = Object.entries(packingData)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 8);

            const maxValue = Math.max(...sortedPacking.map(([,value]) => value));
            
            const chartContainer = document.getElementById('packingChart');
            chartContainer.innerHTML = '';

            sortedPacking.forEach(([packing, value]) => {
                const height = (value / maxValue) * 200;
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = height + 'px';
                bar.innerHTML = `
                    <div class="chart-value">${value.toLocaleString()}</div>
                    <div class="chart-label">${packing.length > 8 ? packing.substring(0, 8) + '...' : packing}</div>
                `;
                chartContainer.appendChild(bar);
            });
        }

        // PO Performance
        function generatePOPerformance() {
            const poData = {};
            
            allData.forEach(row => {
                const po = row['PO'] || 'Unknown';
                const qty = parseFloat(row['QTY MASUK']) || 0;
                const kg = parseFloat(row['KG']) || 0;
                
                if (!poData[po]) {
                    poData[po] = { qty: 0, kg: 0, items: 0 };
                }
                
                poData[po].qty += qty;
                poData[po].kg += kg;
                poData[po].items += 1;
            });

            const sortedPO = Object.entries(poData)
                .map(([po, data]) => ({
                    po,
                    totalQty: data.qty,
                    totalKg: data.kg,
                    items: data.items,
                    efficiency: data.kg > 0 ? (data.qty / data.kg) : 0
                }))
                .sort((a, b) => b.totalQty - a.totalQty)
                .slice(0, 8);

            const container = document.getElementById('poPerformance');
            container.innerHTML = '';

            sortedPO.forEach((po, index) => {
                const item = document.createElement('div');
                item.className = 'top-item';
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-name">#${index + 1} PO: ${po.po}</div>
                        <div class="item-details">${po.items} items  ${po.totalKg.toLocaleString()} kg  Efficiency: ${po.efficiency.toFixed(2)}</div>
                    </div>
                    <div class="item-value">${po.totalQty.toLocaleString()}</div>
                `;
                container.appendChild(item);
            });
        }



        function generateBrandPerformance() {
            const brandPerformance = {};
            
            allData.forEach(row => {
                const brand = row['BRAND'] || 'Unknown';
                const qty = parseFloat(row['QTY MASUK']) || 0;
                const kg = parseFloat(row['KG']) || 0;
                
                if (!brandPerformance[brand]) {
                    brandPerformance[brand] = { qty: 0, kg: 0, items: 0 };
                }
                
                brandPerformance[brand].qty += qty;
                brandPerformance[brand].kg += kg;
                brandPerformance[brand].items += 1;
            });

            const sortedPerformance = Object.entries(brandPerformance)
                .map(([brand, data]) => ({
                    brand,
                    totalQty: data.qty,
                    totalKg: data.kg,
                    items: data.items,
                    avgQty: data.qty / data.items
                }))
                .sort((a, b) => b.totalQty - a.totalQty)
                .slice(0, 8);

            const container = document.getElementById('brandPerformance');
            container.innerHTML = '';

            sortedPerformance.forEach((brand, index) => {
                const item = document.createElement('div');
                item.className = 'top-item';
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-name">#${index + 1} ${brand.brand}</div>
                        <div class="item-details">${brand.items} items  Avg: ${brand.avgQty.toFixed(1)} qty</div>
                    </div>
                    <div class="item-value">${brand.totalQty.toLocaleString()}</div>
                `;
                container.appendChild(item);
            });
        }

        // Toggle filters visibility
        function toggleFilters() {
            const content = document.getElementById('filtersContent');
            const btn = document.getElementById('toggleFiltersBtn');
            
            if (content.style.display === 'none') {
                content.style.display = 'flex';
                btn.innerHTML = ' ';
            } else {
                content.style.display = 'none';
                btn.innerHTML = ' ';
            }
        }

        // Filter change listeners
        document.getElementById('brandFilter').addEventListener('change', applyFilters);
        document.getElementById('sizeFilter').addEventListener('change', applyFilters);

        // Allow Enter key to trigger load
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && document.activeElement.id !== 'searchInput') {
                loadData();
            }
        });

        // Create animated particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 3 + 3) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Auto-load data when page loads
        document.addEventListener('DOMContentLoaded', async function() {
            console.log(' Initializing Data Stok CS...');
            
            // Validate API connection first
            const isConnected = await validateConnection();
            if (!isConnected) {
                document.getElementById('status').className = 'status error';
                document.getElementById('status').textContent = ' Cannot connect to Google Sheets API. Please check your connection.';
                return;
            }
            
            // Get last modified time first
            await getLastModified();
            
            // Auto-load data
            await loadData();
            
            console.log(' Initialization complete');
        });

        // Modal Functions
        function openTableModal() {
            if (filteredData.length === 0) {
                alert('Please load data first!');
                return;
            }
            
            document.getElementById('tableModal').style.display = 'block';
            populateModalTable(filteredData);
            setupModalSearch();
        }

        function openCardModal() {
            if (filteredData.length === 0) {
                alert('Please load data first!');
                return;
            }
            
            document.getElementById('cardModal').style.display = 'block';
            populateCardModal(filteredData);
            setupCardModalSearch();
        }

        function openDetailModal(item) {
            document.getElementById('detailModal').style.display = 'block';
            populateDetailModal(item);
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function populateModalTable(data) {
            const tbody = document.getElementById('modalTableBody');
            tbody.innerHTML = '';

            data.slice(0, 100).forEach(row => { // Limit to 100 items for performance
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="code-cell">${row['PRODUK ID'] || '-'}</td>
                    <td class="brand-cell">${row['BRAND'] || '-'}</td>
                    <td>${row['SIZE'] || '-'}</td>
                    <td class="code-cell">${row['KODE'] || '-'}</td>
                    <td class="numeric">${row['QTY MASUK'] ? parseFloat(row['QTY MASUK']).toLocaleString() : '-'}</td>
                    <td class="numeric">${row['SALDO'] ? parseFloat(row['SALDO']).toLocaleString() : '-'}</td>
                    <td class="numeric">${row['KG'] ? parseFloat(row['KG']).toLocaleString() : '-'}</td>
                    <td>
                        <button onclick="openDetailModal(${JSON.stringify(row).replace(/"/g, '&quot;')})" 
                                style="background: #667eea; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px;">
                            View Details
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            // Update modal stats
            updateModalStats(data);
        }

        function populateCardModal(data) {
            const container = document.getElementById('cardsContainer');
            container.innerHTML = '';

            data.slice(0, 50).forEach(row => { // Limit to 50 cards for performance
                const card = document.createElement('div');
                card.className = 'item-card';
                card.onclick = () => openDetailModal(row);
                
                card.innerHTML = `
                    <div class="card-header">
                        <h3 class="card-title">${row['PRODUK ID'] || 'N/A'}</h3>
                        <span class="card-brand">${row['BRAND'] || 'Unknown'}</span>
                    </div>
                    
                    <div class="card-details">
                        <div class="card-detail">
                            <span class="card-detail-label">Size</span>
                            <span class="card-detail-value">${row['SIZE'] || '-'}</span>
                        </div>
                        <div class="card-detail">
                            <span class="card-detail-label">Code</span>
                            <span class="card-detail-value">${row['KODE'] || '-'}</span>
                        </div>
                        <div class="card-detail">
                            <span class="card-detail-label">PO</span>
                            <span class="card-detail-value">${row['PO'] || '-'}</span>
                        </div>
                        <div class="card-detail">
                            <span class="card-detail-label">Date</span>
                            <span class="card-detail-value">${row['TGL MSK'] || '-'}</span>
                        </div>
                    </div>
                    
                    <div class="card-metrics">
                        <div class="card-metric">
                            <span class="card-metric-value">${row['QTY MASUK'] ? parseFloat(row['QTY MASUK']).toLocaleString() : '0'}</span>
                            <span class="card-metric-label">Qty Masuk</span>
                        </div>
                        <div class="card-metric">
                            <span class="card-metric-value">${row['SALDO'] ? parseFloat(row['SALDO']).toLocaleString() : '0'}</span>
                            <span class="card-metric-label">Saldo</span>
                        </div>
                        <div class="card-metric">
                            <span class="card-metric-value">${row['KG'] ? parseFloat(row['KG']).toLocaleString() : '0'}</span>
                            <span class="card-metric-label">KG</span>
                        </div>
                    </div>
                `;
                
                container.appendChild(card);
            });
        }

        function populateDetailModal(item) {
            document.getElementById('detailTitle').textContent = item['PRODUK ID'] || 'Unknown Product';
            document.getElementById('detailSubtitle').textContent = `${item['BRAND'] || 'Unknown Brand'}  ${item['SIZE'] || 'Unknown Size'}`;
            document.getElementById('detailSaldo').textContent = item['SALDO'] ? parseFloat(item['SALDO']).toLocaleString() : '0';
            
            // Product Information
            document.getElementById('detailProductId').textContent = item['PRODUK ID'] || '-';
            document.getElementById('detailBrand').textContent = item['BRAND'] || '-';
            document.getElementById('detailSize').textContent = item['SIZE'] || '-';
            document.getElementById('detailCode').textContent = item['KODE'] || '-';
            document.getElementById('detailCodeAsal').textContent = item['KODE ASAL'] || '-';
            
            // Inventory Details
            document.getElementById('detailQtyMasuk').textContent = item['QTY MASUK'] ? parseFloat(item['QTY MASUK']).toLocaleString() : '-';
            document.getElementById('detailOffset').textContent = item['OFFSET'] ? parseFloat(item['OFFSET']).toLocaleString() : '-';
            document.getElementById('detailKg').textContent = item['KG'] ? parseFloat(item['KG']).toLocaleString() + ' kg' : '-';
            document.getElementById('detailPacking').textContent = item['PACKING'] || '-';
            document.getElementById('detailTglMasuk').textContent = item['TGL MSK'] || '-';
            
            // Order Information
            document.getElementById('detailPo').textContent = item['PO'] || '-';
            document.getElementById('detailJd').textContent = item['JD'] || '-';
        }

        function switchModalView(view) {
            const tableView = document.getElementById('modalTableView');
            const summaryView = document.getElementById('modalSummaryView');
            const buttons = document.querySelectorAll('.view-btn');
            
            buttons.forEach(btn => btn.classList.remove('active'));
            
            if (view === 'table') {
                tableView.style.display = 'block';
                summaryView.style.display = 'none';
                buttons[0].classList.add('active');
            } else {
                tableView.style.display = 'none';
                summaryView.style.display = 'block';
                buttons[1].classList.add('active');
            }
        }

        function updateModalStats(data) {
            const totalItems = data.length;
            const totalQty = data.reduce((sum, row) => sum + (parseFloat(row['QTY MASUK']) || 0), 0);
            const totalWeight = data.reduce((sum, row) => sum + (parseFloat(row['KG']) || 0), 0);
            
            document.getElementById('modalTotalItems').textContent = totalItems.toLocaleString();
            document.getElementById('modalTotalQty').textContent = totalQty.toLocaleString();
            document.getElementById('modalTotalWeight').textContent = totalWeight.toLocaleString() + ' kg';
        }

        function setupModalSearch() {
            const searchInput = document.getElementById('modalSearchInput');
            let searchTimeout;
            
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    const searchTerm = this.value.toLowerCase().trim();
                    const filtered = filteredData.filter(row => 
                        Object.values(row).some(value => 
                            value && value.toString().toLowerCase().includes(searchTerm)
                        )
                    );
                    populateModalTable(filtered);
                }, 300);
            });
        }

        function setupCardModalSearch() {
            const searchInput = document.getElementById('cardModalSearchInput');
            let searchTimeout;
            
            searchInput.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    const searchTerm = this.value.toLowerCase().trim();
                    const filtered = filteredData.filter(row => 
                        Object.values(row).some(value => 
                            value && value.toString().toLowerCase().includes(searchTerm)
                        )
                    );
                    populateCardModal(filtered);
                }, 300);
            });
        }

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modals = ['tableModal', 'cardModal', 'detailModal'];
            modals.forEach(modalId => {
                const modal = document.getElementById(modalId);
                if (event.target === modal) {
                    closeModal(modalId);
                }
            });
        });

        // Close modal with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                const modals = ['tableModal', 'cardModal', 'detailModal'];
                modals.forEach(modalId => {
                    const modal = document.getElementById(modalId);
                    if (modal.style.display === 'block') {
                        closeModal(modalId);
                    }
                });
            }
        });

        // Quarantine Functions
        function updateQuarantineStats() {
            const totalItems = quarantineData.length;
            let totalQty = 0;
            let totalWeight = 0;

            quarantineData.forEach(row => {
                totalQty += parseFloat(row['QTY MASUK']) || 0;
                totalWeight += parseFloat(row['KG']) || 0;
            });

            document.getElementById('quarantineTotal').textContent = totalItems.toLocaleString();
            document.getElementById('quarantineQty').textContent = totalQty.toLocaleString();
            document.getElementById('quarantineWeight').textContent = totalWeight.toLocaleString();
        }

        function displayQuarantineData() {
            const tableBody = document.getElementById('quarantineTableBody');
            const emptyState = document.getElementById('quarantineEmpty');
            const tableContainer = document.getElementById('quarantineTableContainer');

            if (filteredQuarantineData.length === 0) {
                tableContainer.style.display = 'none';
                emptyState.style.display = 'block';
                return;
            }

            tableContainer.style.display = 'block';
            emptyState.style.display = 'none';
            tableBody.innerHTML = '';

            filteredQuarantineData.forEach(row => {
                const tr = document.createElement('tr');
                tr.style.cursor = 'pointer';
                tr.onclick = () => openDetailModal(row);
                
                tr.innerHTML = `
                    <td class="code-cell">${row['PRODUK ID'] || '-'}</td>
                    <td style="background: #fef2f2; color: #dc2626; font-weight: 600; padding: 8px 12px;">
                         ${row['BRAND'] || 'Unknown'}
                    </td>
                    <td>${row['SIZE'] || '-'}</td>
                    <td class="code-cell">${row['KODE'] || '-'}</td>
                    <td class="numeric">${row['QTY MASUK'] ? parseFloat(row['QTY MASUK']).toLocaleString() : '-'}</td>
                    <td class="numeric">${row['SALDO'] ? parseFloat(row['SALDO']).toLocaleString() : '-'}</td>
                    <td class="numeric">${row['KG'] ? parseFloat(row['KG']).toLocaleString() : '-'}</td>
                    <td class="date-cell">${row['TGL MSK'] || '-'}</td>
                    <td>
                        <button onclick="event.stopPropagation(); openDetailModal(${JSON.stringify(row).replace(/"/g, '&quot;')})" 
                                style="background: #dc2626; color: white; border: none; padding: 6px 12px; border-radius: 6px; cursor: pointer; font-size: 12px; font-weight: 500;">
                             Details
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(tr);
            });
        }

        function applyQuarantineFilters() {
            const searchTerm = document.getElementById('quarantineSearchInput').value.toLowerCase().trim();
            
            filteredQuarantineData = quarantineData.filter(row => {
                return searchTerm === '' || Object.values(row).some(value => 
                    value && value.toString().toLowerCase().includes(searchTerm)
                );
            });
            
            displayQuarantineData();
        }

        function exportQuarantineReport() {
            const currentDate = new Date().toLocaleDateString();
            
            let pdfContent = `
                <html>
                <head>
                    <style>
                        body { font-family: Arial, sans-serif; margin: 20px; }
                        .header { text-align: center; margin-bottom: 30px; background: #fef2f2; padding: 20px; border-radius: 8px; }
                        .header h1 { color: #dc2626; margin: 0; }
                        .header p { color: #991b1b; margin: 5px 0; }
                        .alert { background: #fef2f2; border: 2px solid #fecaca; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
                        .alert h3 { color: #dc2626; margin: 0 0 10px 0; }
                        table { width: 100%; border-collapse: collapse; font-size: 12px; }
                        th, td { border: 1px solid #e5e7eb; padding: 8px; text-align: left; }
                        th { background: #dc2626; color: white; font-weight: bold; }
                        tr:nth-child(even) { background: #fef2f2; }
                        .numeric { text-align: right; }
                        .footer { margin-top: 20px; text-align: center; font-size: 10px; color: #6b7280; }
                        .quarantine-brand { background: #fef2f2; color: #dc2626; font-weight: bold; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1> QUARANTINE REPORT</h1>
                        <p>Generated on ${currentDate}</p>
                        <p>Total Quarantine Items: ${filteredQuarantineData.length}</p>
                    </div>
                    
                    <div class="alert">
                        <h3> ATTENTION REQUIRED</h3>
                        <p>The following items are currently in quarantine status and require immediate attention from the quality control team.</p>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>Product ID</th>
                                <th>Brand Status</th>
                                <th>Size</th>
                                <th>Code</th>
                                <th>Qty Masuk</th>
                                <th>Saldo</th>
                                <th>KG</th>
                                <th>Date Masuk</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${filteredQuarantineData.map(row => `
                                <tr>
                                    <td>${row['PRODUK ID'] || '-'}</td>
                                    <td class="quarantine-brand"> ${row['BRAND'] || 'Unknown'}</td>
                                    <td>${row['SIZE'] || '-'}</td>
                                    <td>${row['KODE'] || '-'}</td>
                                    <td class="numeric">${row['QTY MASUK'] || '-'}</td>
                                    <td class="numeric">${row['SALDO'] || '-'}</td>
                                    <td class="numeric">${row['KG'] || '-'}</td>
                                    <td>${row['TGL MSK'] || '-'}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                    <div class="footer">
                        <p>Quarantine Management System - Stok CS</p>
                        <p style="color: #dc2626; font-weight: bold;"> This report contains items requiring immediate quality control attention</p>
                    </div>
                </body>
                </html>
            `;
            
            const printWindow = window.open('', '_blank');
            printWindow.document.write(pdfContent);
            printWindow.document.close();
            printWindow.focus();
            
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 250);
        }



        // Monthly Trends
        function generateMonthlyTrends() {
            const monthlyData = {};
            
            allData.forEach(row => {
                const dateStr = row['TGL MSK'] || '';
                if (dateStr) {
                    try {
                        let date;
                        if (dateStr.includes('/')) {
                            const parts = dateStr.split('/');
                            if (parts.length === 3) {
                                date = new Date(parts[2], parts[1] - 1, parts[0]);
                            }
                        } else if (dateStr.includes('-')) {
                            date = new Date(dateStr);
                        }
                        
                        if (date && !isNaN(date)) {
                            const monthKey = date.toLocaleDateString('id-ID', { 
                                year: 'numeric', 
                                month: 'short' 
                            });
                            const qty = parseFloat(row['QTY MASUK']) || 0;
                            
                            if (!monthlyData[monthKey]) {
                                monthlyData[monthKey] = 0;
                            }
                            monthlyData[monthKey] += qty;
                        }
                    } catch (e) {
                        // Skip invalid dates
                    }
                }
            });

            const sortedMonths = Object.entries(monthlyData)
                .sort(([a], [b]) => new Date(a) - new Date(b))
                .slice(-6); // Last 6 months

            const chartContainer = document.getElementById('monthlyTrendsChart');
            chartContainer.innerHTML = '';

            if (sortedMonths.length === 0) {
                chartContainer.innerHTML = '<div style="text-align: center; color: #6b7280; margin-top: 100px;">No monthly data available</div>';
                return;
            }

            const maxValue = Math.max(...sortedMonths.map(([, qty]) => qty));

            sortedMonths.forEach(([month, qty]) => {
                const height = maxValue > 0 ? (qty / maxValue) * 200 : 0;
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = height + 'px';
                bar.innerHTML = `
                    <div class="chart-value">${qty.toLocaleString()}</div>
                    <div class="chart-label">${month}</div>
                `;
                chartContainer.appendChild(bar);
            });
        }



        // Top Performing Codes
        function generateTopCodes() {
            const codeData = {};
            
            allData.forEach(row => {
                const code = row['KODE'] || 'Unknown';
                const saldo = parseFloat(row['SALDO']) || 0;
                const kg = parseFloat(row['KG']) || 0;
                
                if (!codeData[code]) {
                    codeData[code] = { saldo: 0, kg: 0, items: 0 };
                }
                
                codeData[code].saldo += saldo;
                codeData[code].kg += kg;
                codeData[code].items += 1;
            });

            const sortedCodes = Object.entries(codeData)
                .map(([code, data]) => ({
                    code,
                    totalSaldo: data.saldo,
                    totalKg: data.kg,
                    items: data.items,
                    density: data.kg > 0 ? (data.saldo / data.kg) : 0
                }))
                .sort((a, b) => b.totalSaldo - a.totalSaldo)
                .slice(0, 8);

            const container = document.getElementById('topCodes');
            container.innerHTML = '';

            sortedCodes.forEach((code, index) => {
                const item = document.createElement('div');
                item.className = 'top-item';
                item.innerHTML = `
                    <div class="item-info">
                        <div class="item-name">#${index + 1} ${code.code}</div>
                        <div class="item-details">${code.items} items  ${code.totalKg.toLocaleString()} kg  Density: ${code.density.toFixed(2)}</div>
                    </div>
                    <div class="item-value">${code.totalSaldo.toLocaleString()}</div>
                `;
                container.appendChild(item);
            });
        }

        // Inventory Distribution
        function generateInventoryDistribution() {
            const brandData = {};
            
            allData.forEach(row => {
                const brand = row['BRAND'] || 'Unknown';
                const qty = parseFloat(row['QTY MASUK']) || 0;
                brandData[brand] = (brandData[brand] || 0) + qty;
            });

            const sortedBrands = Object.entries(brandData)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 6);

            const total = sortedBrands.reduce((sum, [, qty]) => sum + qty, 0);
            
            const container = document.getElementById('inventoryDistribution');
            container.innerHTML = '';

            sortedBrands.forEach(([brand, qty]) => {
                const percentage = total > 0 ? (qty / total * 100) : 0;
                
                const barElement = document.createElement('div');
                barElement.className = 'distribution-bar';
                barElement.innerHTML = `
                    <div class="distribution-label">${brand.length > 8 ? brand.substring(0, 8) + '...' : brand}</div>
                    <div class="distribution-bar-container">
                        <div class="distribution-bar-fill" style="width: ${percentage}%"></div>
                        <div class="distribution-value">${percentage.toFixed(1)}%</div>
                    </div>
                `;
                container.appendChild(barElement);
            });
        }

        // Setup quarantine search
        document.getElementById('quarantineSearchInput').addEventListener('input', applyQuarantineFilters);
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9859abb2e5a33d95',t:'MTc1ODk2MjE1OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
