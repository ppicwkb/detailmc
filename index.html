<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stok CS WKB - by PPIC</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header fade-in">
            <h1>STOK CS WKB</h1>
            <p>Inventory Dashboard by PPIC</p>
            <div class="status-bar">
                <div class="status-item">
                    <div class="status-indicator"></div>
                    <span>Online</span>
                </div>
                <div class="status-item" id="lastModified">
                    <span>Last Updated: Loading...</span>
                </div>
            </div>
        </header>
        
        <div class="controls fade-in" style="animation-delay: 0.1s;">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchTab('inventory')" id="inventoryTab">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125" />
                    </svg>
                    Inventory Data
                </button>
                <button class="nav-tab" onclick="switchTab('dashboard')" id="dashboardTab">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="20" height="20">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 016 3.75h2.25A2.25 2.25 0 0110.5 6v2.25a2.25 2.25 0 01-2.25 2.25H6a2.25 2.25 0 01-2.25-2.25V6zM3.75 15.75A2.25 2.25 0 016 13.5h2.25a2.25 2.25 0 012.25 2.25V18a2.25 2.25 0 01-2.25 2.25H6A2.25 2.25 0 013.75 18v-2.25zM13.5 6a2.25 2.25 0 012.25-2.25H18A2.25 2.25 0 0120.25 6v2.25A2.25 2.25 0 0118 10.5h-2.25a2.25 2.25 0 01-2.25-2.25V6zM13.5 15.75a2.25 2.25 0 012.25-2.25H18a2.25 2.25 0 012.25 2.25V18A2.25 2.25 0 0118 20.25h-2.25A2.25 2.25 0 0113.5 18v-2.25z" />
                    </svg>
                    Location Overview
                </button>
            </div>
        </div>

        <div id="inventoryContent" class="tab-content active">
            <div class="controls fade-in" style="animation-delay: 0.2s;">
                <div class="filter-section">
                    <h3>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" width="16" height="16">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
                        </svg>
                        Search & Filters
                    </h3>
                    <div class="search-wrapper" style="margin-bottom: 1.5rem;">
                        <span class="search-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                            </svg>
                        </span>
                        <input type="text" class="search-input" id="globalSearch" placeholder="Search across all fields...">
                    </div>
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label for="searchProduk">Product ID</label>
                            <input type="text" id="searchProduk" placeholder="Type product ID..." list="produkList">
                            <datalist id="produkList"></datalist>
                        </div>
                        <div class="filter-group">
                            <label for="searchPacking">Packing</label>
                            <input type="text" id="searchPacking" placeholder="Type packing..." list="packingList">
                            <datalist id="packingList"></datalist>
                        </div>
                        <div class="filter-group">
                            <label for="searchBrand">Brand</label>
                            <input type="text" id="searchBrand" placeholder="Type brand..." list="brandList">
                            <datalist id="brandList"></datalist>
                        </div>
                        <div class="filter-group">
                            <label for="searchPO">PO</label>
                            <input type="text" id="searchPO" placeholder="Type PO..." list="poList">
                            <datalist id="poList"></datalist>
                        </div>
                        <div class="filter-group">
                            <label for="filterLocation">Location</label>
                            <select id="filterLocation">
                                <option value="">All Locations</option>
                                <option value="GIM">GIM</option>
                                <option value="WKB">WKB</option>
                                <option value="CONT">CONT</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <button class="btn btn-primary" onclick="applyFilters()">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.572a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z" />
                        </svg>
                        Apply Filters
                    </button>
                    <button class="btn btn-secondary" onclick="clearFilters()">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0011.664 0l3.18-3.182m-3.182-4.991v4.99" />
                        </svg>
                        Clear All
                    </button>
                    <button class="btn btn-success" onclick="exportToExcel()">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 01-1.125-1.125v-1.5c0-.621.504-1.125 1.125-1.125H3.375m17.25 0a1.125 1.125 0 001.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-1.875m-14.25-7.5l1.5-1.5m0 0l1.5 1.5m-1.5-1.5v11.25m1.5-11.25l1.5 1.5m-1.5-1.5v11.25m1.5-11.25l1.5 1.5m-1.5-1.5v11.25m1.5-11.25l1.5 1.5M12 19.5v-11.25m0 0l1.5 1.5m-1.5-1.5l-1.5-1.5m0 0v11.25m-1.5-11.25l-1.5 1.5m1.5-1.5v11.25m1.5-1.5l-1.5 1.5m0 0v11.25m6.75-11.25v11.25m0 0l-1.5 1.5m1.5-1.5l-1.5-1.5m0 0v-11.25m-1.5 11.25l-1.5-1.5m1.5 1.5V8.25m1.5 0v11.25" />
                        </svg>
                        Export Excel
                    </button>
                    <button class="btn btn-info" onclick="exportToPDF()">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                        </svg>
                        Export PDF
                    </button>
                </div>
            </div>
            
            <div class="data-container fade-in" style="animation-delay: 0.3s;">
                <div id="loadingIndicator" class="loading">
                    <div class="spinner"></div>
                    <p>Loading inventory data...</p>
                </div>
                
                <div id="errorMessage" class="error-message" style="display: none;"></div>
                
                <div id="dataDisplay" style="display: none;">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalProducts">-</div>
                            <div class="stat-label">Total Products</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalSaldo">-</div>
                            <div class="stat-label">Total Cartons</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalKg">-</div>
                            <div class="stat-label">Total Weight (KG)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="uniqueBrands">-</div>
                            <div class="stat-label">Active Brands</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="uniqueLocations">-</div>
                            <div class="stat-label">Active Locations</div>
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table id="inventoryTable">
                            <thead>
                                <tr>
                                    <th>Product ID</th>
                                    <th>Packing</th>
                                    <th>Brand</th>
                                    <th>PO</th>
                                    <th>Saldo (Carton)</th>
                                    <th>Weight (KG)</th>
                                    <th>Location</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody"></tbody>
                        </table>
                    </div>
                    
                    <div class="pagination" id="paginationContainer"></div>
                </div>
            </div>
        </div>

        <div id="dashboardContent" class="tab-content">
            <div class="data-container fade-in">
                <h2 style="text-align: center; margin: 0 0 2rem 0;">Location Analytics Dashboard</h2>
                <div class="dashboard-grid">
                    <div class="location-card">
                        <div class="location-header">
                            <h3>WKB</h3>
                            <span class="location-badge wkb">Winaros K.B.</span>
                        </div>
                        <div class="location-stats">
                            <div class="location-stat">
                                <div class="stat-icon-large">üì¶</div>
                                <div class="stat-info">
                                    <div class="stat-value" id="wkbSaldo">-</div>
                                    <div class="stat-unit">Cartons</div>
                                </div>
                            </div>
                            <div class="location-stat">
                                <div class="stat-icon-large">‚öñÔ∏è</div>
                                <div class="stat-info">
                                    <div class="stat-value" id="wkbKg">-</div>
                                    <div class="stat-unit">Kilograms</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="location-card">
                        <div class="location-header">
                            <h3>GIM</h3>
                            <span class="location-badge gim">Gudang I.M.</span>
                        </div>
                        <div class="location-stats">
                            <div class="location-stat">
                                <div class="stat-icon-large">üì¶</div>
                                <div class="stat-info">
                                    <div class="stat-value" id="gimSaldo">-</div>
                                    <div class="stat-unit">Cartons</div>
                                </div>
                            </div>
                            <div class="location-stat">
                                <div class="stat-icon-large">‚öñÔ∏è</div>
                                <div class="stat-info">
                                    <div class="stat-value" id="gimKg">-</div>
                                    <div class="stat-unit">Kilograms</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="location-card">
                        <div class="location-header">
                            <h3>CONT</h3>
                            <span class="location-badge cont">Container</span>
                        </div>
                        <div class="location-stats">
                            <div class="location-stat">
                                <div class="stat-icon-large">üì¶</div>
                                <div class="stat-info">
                                    <div class="stat-value" id="contSaldo">-</div>
                                    <div class="stat-unit">Cartons</div>
                                </div>
                            </div>
                            <div class="location-stat">
                                <div class="stat-icon-large">‚öñÔ∏è</div>
                                <div class="stat-info">
                                    <div class="stat-value" id="contKg">-</div>
                                    <div class="stat-unit">Kilograms</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="location-card">
                        <div class="location-header">
                            <h3>TOTAL</h3>
                            <span class="location-badge total">All Locations</span>
                        </div>
                        <div class="location-stats">
                            <div class="location-stat">
                                <div class="stat-icon-large">üì¶</div>
                                <div class="stat-info">
                                    <div class="stat-value" id="totalAllSaldo">-</div>
                                    <div class="stat-unit">Cartons</div>
                                </div>
                            </div>
                            <div class="location-stat">
                                <div class="stat-icon-large">‚öñÔ∏è</div>
                                <div class="stat-info">
                                    <div class="stat-value" id="totalAllKg">-</div>
                                    <div class="stat-unit">Kilograms</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>